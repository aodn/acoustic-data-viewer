(function(){var l=this,U=l._,K={},C=Array.prototype,W=Object.prototype,A=C.slice,S=C.unshift,R=W.toString,u=W.hasOwnProperty,T=C.forEach,J=C.map,k=C.reduce,D=C.reduceRight,H=C.filter,L=C.every,o=C.some,v=C.indexOf,E=C.lastIndexOf;W=Array.isArray;var P=Object.keys,g=Function.prototype.bind,h=function(i){return new B(i)};typeof module!=="undefined"&&module.exports?(module.exports=h,h._=h):l._=h;h.VERSION="1.1.7";var y=h.each=h.forEach=function(i,q,z){if(i!=null)if(T&&i.forEach===T)i.forEach(q,z);else if(i.length===
+i.length)for(var G=0,O=i.length;G<O;G++){if(G in i&&q.call(z,i[G],G,i)===K)break}else for(G in i)if(u.call(i,G)&&q.call(z,i[G],G,i)===K)break};h.map=function(i,q,z){var G=[];if(i==null)return G;if(J&&i.map===J)return i.map(q,z);y(i,function(O,Z,ha){G[G.length]=q.call(z,O,Z,ha)});return G};h.reduce=h.foldl=h.inject=function(i,q,z,G){var O=z!==void 0;i==null&&(i=[]);if(k&&i.reduce===k)return G&&(q=h.bind(q,G)),O?i.reduce(q,z):i.reduce(q);y(i,function(Z,ha,ca){O?z=q.call(G,z,Z,ha,ca):(z=Z,O=true)});
if(!O)throw new TypeError("Reduce of empty array with no initial value");return z};h.reduceRight=h.foldr=function(i,q,z,G){i==null&&(i=[]);if(D&&i.reduceRight===D)return G&&(q=h.bind(q,G)),z!==void 0?i.reduceRight(q,z):i.reduceRight(q);i=(h.isArray(i)?i.slice():h.toArray(i)).reverse();return h.reduce(i,q,z,G)};h.find=h.detect=function(i,q,z){var G;p(i,function(O,Z,ha){if(q.call(z,O,Z,ha))return G=O,true});return G};h.filter=h.select=function(i,q,z){var G=[];if(i==null)return G;if(H&&i.filter===H)return i.filter(q,
z);y(i,function(O,Z,ha){q.call(z,O,Z,ha)&&(G[G.length]=O)});return G};h.reject=function(i,q,z){var G=[];if(i==null)return G;y(i,function(O,Z,ha){q.call(z,O,Z,ha)||(G[G.length]=O)});return G};h.every=h.all=function(i,q,z){var G=true;if(i==null)return G;if(L&&i.every===L)return i.every(q,z);y(i,function(O,Z,ha){if(!(G=G&&q.call(z,O,Z,ha)))return K});return G};var p=h.some=h.any=function(i,q,z){q=q||h.identity;var G=false;if(i==null)return G;if(o&&i.some===o)return i.some(q,z);y(i,function(O,Z,ha){if(G|=
q.call(z,O,Z,ha))return K});return!!G};h.include=h.contains=function(i,q){var z=false;if(i==null)return z;if(v&&i.indexOf===v)return i.indexOf(q)!=-1;p(i,function(G){if(z=G===q)return true});return z};h.invoke=function(i,q){var z=A.call(arguments,2);return h.map(i,function(G){return(q.call?q||G:G[q]).apply(G,z)})};h.pluck=function(i,q){return h.map(i,function(z){return z[q]})};h.max=function(i,q,z){if(!q&&h.isArray(i))return Math.max.apply(Math,i);var G={computed:-Infinity};y(i,function(O,Z,ha){Z=
q?q.call(z,O,Z,ha):O;Z>=G.computed&&(G={value:O,computed:Z})});return G.value};h.min=function(i,q,z){if(!q&&h.isArray(i))return Math.min.apply(Math,i);var G={computed:Infinity};y(i,function(O,Z,ha){Z=q?q.call(z,O,Z,ha):O;Z<G.computed&&(G={value:O,computed:Z})});return G.value};h.sortBy=function(i,q,z){return h.pluck(h.map(i,function(G,O,Z){return{value:G,criteria:q.call(z,G,O,Z)}}).sort(function(G,O){var Z=G.criteria,ha=O.criteria;return Z<ha?-1:Z>ha?1:0}),"value")};h.groupBy=function(i,q){var z=
{};y(i,function(G,O){var Z=q(G,O);(z[Z]||(z[Z]=[])).push(G)});return z};h.sortedIndex=function(i,q,z){z||(z=h.identity);for(var G=0,O=i.length;G<O;){var Z=G+O>>1;z(i[Z])<z(q)?G=Z+1:O=Z}return G};h.toArray=function(i){if(!i)return[];if(i.toArray)return i.toArray();if(h.isArray(i))return A.call(i);if(h.isArguments(i))return A.call(i);return h.values(i)};h.size=function(i){return h.toArray(i).length};h.first=h.head=function(i,q,z){return q!=null&&!z?A.call(i,0,q):i[0]};h.rest=h.tail=function(i,q,z){return A.call(i,
q==null||z?1:q)};h.last=function(i){return i[i.length-1]};h.compact=function(i){return h.filter(i,function(q){return!!q})};h.flatten=function(i){return h.reduce(i,function(q,z){if(h.isArray(z))return q.concat(h.flatten(z));q[q.length]=z;return q},[])};h.without=function(i){return h.difference(i,A.call(arguments,1))};h.uniq=h.unique=function(i,q){return h.reduce(i,function(z,G,O){if(0==O||(q===true?h.last(z)!=G:!h.include(z,G)))z[z.length]=G;return z},[])};h.union=function(){return h.uniq(h.flatten(arguments))};
h.intersection=h.intersect=function(i){var q=A.call(arguments,1);return h.filter(h.uniq(i),function(z){return h.every(q,function(G){return h.indexOf(G,z)>=0})})};h.difference=function(i,q){return h.filter(i,function(z){return!h.include(q,z)})};h.zip=function(){for(var i=A.call(arguments),q=h.max(h.pluck(i,"length")),z=Array(q),G=0;G<q;G++)z[G]=h.pluck(i,""+G);return z};h.indexOf=function(i,q,z){if(i==null)return-1;var G;if(z)return z=h.sortedIndex(i,q),i[z]===q?z:-1;if(v&&i.indexOf===v)return i.indexOf(q);
z=0;for(G=i.length;z<G;z++)if(i[z]===q)return z;return-1};h.lastIndexOf=function(i,q){if(i==null)return-1;if(E&&i.lastIndexOf===E)return i.lastIndexOf(q);for(var z=i.length;z--;)if(i[z]===q)return z;return-1};h.range=function(i,q,z){arguments.length<=1&&(q=i||0,i=0);z=arguments[2]||1;for(var G=Math.max(Math.ceil((q-i)/z),0),O=0,Z=Array(G);O<G;){Z[O++]=i;i+=z}return Z};h.bind=function(i,q){if(i.bind===g&&g)return g.apply(i,A.call(arguments,1));var z=A.call(arguments,2);return function(){return i.apply(q,
z.concat(A.call(arguments)))}};h.bindAll=function(i){var q=A.call(arguments,1);q.length==0&&(q=h.functions(i));y(q,function(z){i[z]=h.bind(i[z],i)});return i};h.memoize=function(i,q){var z={};q||(q=h.identity);return function(){var G=q.apply(this,arguments);return u.call(z,G)?z[G]:z[G]=i.apply(this,arguments)}};h.delay=function(i,q){var z=A.call(arguments,2);return setTimeout(function(){return i.apply(i,z)},q)};h.defer=function(i){return h.delay.apply(h,[i,1].concat(A.call(arguments,1)))};var m=function(i,
q,z){var G;return function(){var O=this,Z=arguments,ha=function(){G=null;i.apply(O,Z)};z&&clearTimeout(G);if(z||!G)G=setTimeout(ha,q)}};h.throttle=function(i,q){return m(i,q,false)};h.debounce=function(i,q){return m(i,q,true)};h.once=function(i){var q=false,z;return function(){if(q)return z;q=true;return z=i.apply(this,arguments)}};h.wrap=function(i,q){return function(){var z=[i].concat(A.call(arguments));return q.apply(this,z)}};h.compose=function(){var i=A.call(arguments);return function(){for(var q=
A.call(arguments),z=i.length-1;z>=0;z--)q=[i[z].apply(this,q)];return q[0]}};h.after=function(i,q){return function(){if(--i<1)return q.apply(this,arguments)}};h.keys=P||function(i){if(i!==Object(i))throw new TypeError("Invalid object");var q=[],z;for(z in i)u.call(i,z)&&(q[q.length]=z);return q};h.values=function(i){return h.map(i,h.identity)};h.functions=h.methods=function(i){var q=[],z;for(z in i)h.isFunction(i[z])&&q.push(z);return q.sort()};h.extend=function(i){y(A.call(arguments,1),function(q){for(var z in q)q[z]!==
void 0&&(i[z]=q[z])});return i};h.defaults=function(i){y(A.call(arguments,1),function(q){for(var z in q)i[z]==null&&(i[z]=q[z])});return i};h.clone=function(i){return h.isArray(i)?i.slice():h.extend({},i)};h.tap=function(i,q){q(i);return i};h.isEqual=function(i,q){if(i===q)return true;var z=typeof i;if(z!=typeof q)return false;if(i==q)return true;if(!i&&q||i&&!q)return false;if(i._chain)i=i._wrapped;if(q._chain)q=q._wrapped;if(i.isEqual)return i.isEqual(q);if(q.isEqual)return q.isEqual(i);if(h.isDate(i)&&
h.isDate(q))return i.getTime()===q.getTime();if(h.isNaN(i)&&h.isNaN(q))return false;if(h.isRegExp(i)&&h.isRegExp(q))return i.source===q.source&&i.global===q.global&&i.ignoreCase===q.ignoreCase&&i.multiline===q.multiline;if(z!=="object")return false;if(i.length&&i.length!==q.length)return false;z=h.keys(i);var G=h.keys(q);if(z.length!=G.length)return false;for(var O in i)if(!(O in q)||!h.isEqual(i[O],q[O]))return false;return true};h.isEmpty=function(i){if(h.isArray(i)||h.isString(i))return i.length===
0;for(var q in i)if(u.call(i,q))return false;return true};h.isElement=function(i){return!!(i&&i.nodeType==1)};h.isArray=W||function(i){return R.call(i)==="[object Array]"};h.isObject=function(i){return i===Object(i)};h.isArguments=function(i){return!(!i||!u.call(i,"callee"))};h.isFunction=function(i){return!(!i||!i.constructor||!i.call||!i.apply)};h.isString=function(i){return!!(i===""||i&&i.charCodeAt&&i.substr)};h.isNumber=function(i){return!!(i===0||i&&i.toExponential&&i.toFixed)};h.isNaN=function(i){return i!==
i};h.isBoolean=function(i){return i===true||i===false};h.isDate=function(i){return!(!i||!i.getTimezoneOffset||!i.setUTCFullYear)};h.isRegExp=function(i){return!(!i||!i.test||!i.exec||!(i.ignoreCase||i.ignoreCase===false))};h.isNull=function(i){return i===null};h.isUndefined=function(i){return i===void 0};h.noConflict=function(){l._=U;return this};h.identity=function(i){return i};h.times=function(i,q,z){for(var G=0;G<i;G++)q.call(z,G)};h.mixin=function(i){y(h.functions(i),function(q){Q(q,h[q]=i[q])})};
var x=0;h.uniqueId=function(i){var q=x++;return i?i+q:q};h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};h.template=function(i,q){var z=h.templateSettings;z="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+i.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(z.interpolate,function(G,O){return"',"+O.replace(/\\'/g,"'")+",'"}).replace(z.evaluate||null,function(G,O){return"');"+O.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,
"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";z=new Function("obj",z);return q?z(q):z};var B=function(i){this._wrapped=i};h.prototype=B.prototype;var F=function(i,q){return q?h(i).chain():i},Q=function(i,q){B.prototype[i]=function(){var z=A.call(arguments);S.call(z,this._wrapped);return F(q.apply(h,z),this._chain)}};h.mixin(h);y(["pop","push","reverse","shift","sort","splice","unshift"],function(i){var q=C[i];B.prototype[i]=function(){q.apply(this._wrapped,arguments);
return F(this._wrapped,this._chain)}});y(["concat","join","slice"],function(i){var q=C[i];B.prototype[i]=function(){return F(q.apply(this._wrapped,arguments),this._chain)}});B.prototype.chain=function(){this._chain=true;return this};B.prototype.value=function(){return this._wrapped}})();(function(){var l=this,U=l.Backbone,K;K=typeof exports!=="undefined"?exports:l.Backbone={};K.VERSION="0.5.3";var C=l._;if(!C&&typeof require!=="undefined")C=require("underscore")._;var W=l.jQuery||l.Zepto;K.noConflict=function(){l.Backbone=U;return this};K.emulateHTTP=false;K.emulateJSON=false;K.Events={bind:function(g,h,y){var p=this._callbacks||(this._callbacks={});(p[g]||(p[g]=[])).push([h,y]);return this},unbind:function(g,h){var y;if(g){if(y=this._callbacks)if(h){y=y[g];if(!y)return this;for(var p=
0,m=y.length;p<m;p++)if(y[p]&&h===y[p][0]){y[p]=null;break}}else y[g]=[]}else this._callbacks={};return this},trigger:function(g){var h,y,p,m,x=2;if(!(y=this._callbacks))return this;for(;x--;)if(h=x?g:"all",h=y[h])for(var B=0,F=h.length;B<F;B++)(p=h[B])?(m=x?Array.prototype.slice.call(arguments,1):arguments,p[0].apply(p[1]||this,m)):(h.splice(B,1),B--,F--);return this}};K.Model=function(g,h){var y;g||(g={});if(y=this.defaults){C.isFunction(y)&&(y=y.call(this));g=C.extend({},y,g)}this.attributes={};
this._escapedAttributes={};this.cid=C.uniqueId("c");this.set(g,{silent:true});this._changed=false;this._previousAttributes=C.clone(this.attributes);if(h&&h.collection)this.collection=h.collection;this.initialize(g,h)};C.extend(K.Model.prototype,K.Events,{_previousAttributes:null,_changed:false,idAttribute:"id",initialize:function(){},toJSON:function(){return C.clone(this.attributes)},get:function(g){return this.attributes[g]},escape:function(g){var h;if(h=this._escapedAttributes[g])return h;h=this.attributes[g];
return this._escapedAttributes[g]=(h==null?"":""+h).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},has:function(g){return this.attributes[g]!=null},set:function(g,h){h||(h={});if(!g)return this;if(g.attributes)g=g.attributes;var y=this.attributes,p=this._escapedAttributes;if(!h.silent&&this.validate&&!this._performValidation(g,h))return false;if(this.idAttribute in g)this.id=g[this.idAttribute];
var m=this._changing;this._changing=true;for(var x in g){var B=g[x];if(!C.isEqual(y[x],B)){y[x]=B;delete p[x];this._changed=true;h.silent||this.trigger("change:"+x,this,B,h)}}!m&&!h.silent&&this._changed&&this.change(h);this._changing=false;return this},unset:function(g,h){if(!(g in this.attributes))return this;h||(h={});var y={};y[g]=void 0;if(!h.silent&&this.validate&&!this._performValidation(y,h))return false;delete this.attributes[g];delete this._escapedAttributes[g];g==this.idAttribute&&delete this.id;
this._changed=true;h.silent||(this.trigger("change:"+g,this,void 0,h),this.change(h));return this},clear:function(g){g||(g={});var h,y=this.attributes,p={};for(h in y)p[h]=void 0;if(!g.silent&&this.validate&&!this._performValidation(p,g))return false;this.attributes={};this._escapedAttributes={};this._changed=true;if(!g.silent){for(h in y)this.trigger("change:"+h,this,void 0,g);this.change(g)}return this},fetch:function(g){g||(g={});var h=this,y=g.success;g.success=function(p,m,x){if(!h.set(h.parse(p,
x),g))return false;y&&y(h,p)};g.error=P(g.error,h,g);return(this.sync||K.sync).call(this,"read",this,g)},save:function(g,h){h||(h={});if(g&&!this.set(g,h))return false;var y=this,p=h.success;h.success=function(x,B,F){if(!y.set(y.parse(x,F),h))return false;p&&p(y,x,F)};h.error=P(h.error,y,h);var m=this.isNew()?"create":"update";return(this.sync||K.sync).call(this,m,this,h)},destroy:function(g){g||(g={});if(this.isNew())return this.trigger("destroy",this,this.collection,g);var h=this,y=g.success;g.success=
function(p){h.trigger("destroy",h,h.collection,g);y&&y(h,p)};g.error=P(g.error,h,g);return(this.sync||K.sync).call(this,"delete",this,g)},url:function(){var g=v(this.collection)||this.urlRoot||E();if(this.isNew())return g;return g+(g.charAt(g.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(g){return g},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(g){this.trigger("change",this,g);this._previousAttributes=C.clone(this.attributes);
this._changed=false},hasChanged:function(g){if(g)return this._previousAttributes[g]!=this.attributes[g];return this._changed},changedAttributes:function(g){g||(g=this.attributes);var h=this._previousAttributes,y=false,p;for(p in g)C.isEqual(h[p],g[p])||(y=y||{},y[p]=g[p]);return y},previous:function(g){if(!g||!this._previousAttributes)return null;return this._previousAttributes[g]},previousAttributes:function(){return C.clone(this._previousAttributes)},_performValidation:function(g,h){var y=this.validate(g);
if(y)return h.error?h.error(this,y,h):this.trigger("error",this,y,h),false;return true}});K.Collection=function(g,h){h||(h={});if(h.comparator)this.comparator=h.comparator;C.bindAll(this,"_onModelEvent","_removeReference");this._reset();g&&this.reset(g,{silent:true});this.initialize.apply(this,arguments)};C.extend(K.Collection.prototype,K.Events,{model:K.Model,initialize:function(){},toJSON:function(){return this.map(function(g){return g.toJSON()})},add:function(g,h){if(C.isArray(g))for(var y=0,p=
g.length;y<p;y++)this._add(g[y],h);else this._add(g,h);return this},remove:function(g,h){if(C.isArray(g))for(var y=0,p=g.length;y<p;y++)this._remove(g[y],h);else this._remove(g,h);return this},get:function(g){if(g==null)return null;return this._byId[g.id!=null?g.id:g]},getByCid:function(g){return g&&this._byCid[g.cid||g]},at:function(g){return this.models[g]},sort:function(g){g||(g={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);
g.silent||this.trigger("reset",this,g);return this},pluck:function(g){return C.map(this.models,function(h){return h.get(g)})},reset:function(g,h){g||(g=[]);h||(h={});this.each(this._removeReference);this._reset();this.add(g,{silent:true});h.silent||this.trigger("reset",this,h);return this},fetch:function(g){g||(g={});var h=this,y=g.success;g.success=function(p,m,x){h[g.add?"add":"reset"](h.parse(p,x),g);y&&y(h,p)};g.error=P(g.error,h,g);return(this.sync||K.sync).call(this,"read",this,g)},create:function(g,
h){var y=this;h||(h={});g=this._prepareModel(g,h);if(!g)return false;var p=h.success;h.success=function(m,x,B){y.add(m,h);p&&p(m,x,B)};g.save(null,h);return g},parse:function(g){return g},chain:function(){return C(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(g,h){if(g instanceof K.Model){if(!g.collection)g.collection=this}else{var y=g;g=new this.model(y,{collection:this});g.validate&&!g._performValidation(y,h)&&(g=false)}return g},
_add:function(g,h){h||(h={});g=this._prepareModel(g,h);if(!g)return false;var y=this.getByCid(g);if(y)throw Error(["Can't add the same model to a set twice",y.id]);this._byId[g.id]=g;this._byCid[g.cid]=g;this.models.splice(h.at!=null?h.at:this.comparator?this.sortedIndex(g,this.comparator):this.length,0,g);g.bind("all",this._onModelEvent);this.length++;h.silent||g.trigger("add",g,this,h);return g},_remove:function(g,h){h||(h={});g=this.getByCid(g)||this.get(g);if(!g)return null;delete this._byId[g.id];
delete this._byCid[g.cid];this.models.splice(this.indexOf(g),1);this.length--;h.silent||g.trigger("remove",g,this,h);this._removeReference(g);return g},_removeReference:function(g){this==g.collection&&delete g.collection;g.unbind("all",this._onModelEvent)},_onModelEvent:function(g,h,y,p){(g=="add"||g=="remove")&&y!=this||(g=="destroy"&&this._remove(h,p),h&&g==="change:"+h.idAttribute&&(delete this._byId[h.previous(h.idAttribute)],this._byId[h.id]=h),this.trigger.apply(this,arguments))}});C.each(["forEach",
"each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"],function(g){K.Collection.prototype[g]=function(){return C[g].apply(C,[this.models].concat(C.toArray(arguments)))}});K.Router=function(g){g||(g={});if(g.routes)this.routes=g.routes;this._bindRoutes();this.initialize.apply(this,arguments)};
var A=/:([\w\d]+)/g,S=/\*([\w\d]+)/g,R=/[-[\]{}()+?.,\\^$|#\s]/g;C.extend(K.Router.prototype,K.Events,{initialize:function(){},route:function(g,h,y){K.history||(K.history=new K.History);C.isRegExp(g)||(g=this._routeToRegExp(g));K.history.route(g,C.bind(function(p){p=this._extractParameters(g,p);y.apply(this,p);this.trigger.apply(this,["route:"+h].concat(p))},this))},navigate:function(g,h){K.history.navigate(g,h)},_bindRoutes:function(){if(this.routes){var g=[],h;for(h in this.routes)g.unshift([h,
this.routes[h]]);h=0;for(var y=g.length;h<y;h++)this.route(g[h][0],g[h][1],this[g[h][1]])}},_routeToRegExp:function(g){g=g.replace(R,"\\$&").replace(A,"([^/]*)").replace(S,"(.*?)");return RegExp("^"+g+"$")},_extractParameters:function(g,h){return g.exec(h).slice(1)}});K.History=function(){this.handlers=[];C.bindAll(this,"checkUrl")};var u=/^#*/,T=/msie [\w.]+/,J=false;C.extend(K.History.prototype,{interval:50,getFragment:function(g,h){if(g==null)if(this._hasPushState||h){g=window.location.pathname;
var y=window.location.search;y&&(g+=y);g.indexOf(this.options.root)==0&&(g=g.substr(this.options.root.length))}else g=window.location.hash;return decodeURIComponent(g.replace(u,""))},start:function(g){if(J)throw Error("Backbone.history has already been started");this.options=C.extend({},{root:"/"},this.options,g);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);g=this.getFragment();var h=document.documentMode;if(h=
T.exec(navigator.userAgent.toLowerCase())&&(!h||h<=7)){this.iframe=W('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(g)}this._hasPushState?W(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!h?W(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);this.fragment=g;J=true;g=window.location;h=g.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,
true),window.location.replace(this.options.root+"#"+this.fragment),true;else if(this._wantsPushState&&this._hasPushState&&h&&g.hash){this.fragment=g.hash.replace(u,"");window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment)}if(!this.options.silent)return this.loadUrl()},route:function(g,h){this.handlers.unshift({route:g,callback:h})},checkUrl:function(){var g=this.getFragment();g==this.fragment&&this.iframe&&(g=this.getFragment(this.iframe.location.hash));
if(g==this.fragment||g==decodeURIComponent(this.fragment))return false;this.iframe&&this.navigate(g);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(g){var h=this.fragment=this.getFragment(g);return C.any(this.handlers,function(y){if(y.route.test(h))return y.callback(h),true})},navigate:function(g,h){var y=(g||"").replace(u,"");if(!(this.fragment==y||this.fragment==decodeURIComponent(y))){if(this._hasPushState){var p=window.location;y.indexOf(this.options.root)!=0&&(y=this.options.root+
y);this.fragment=y;window.history.pushState({},document.title,p.protocol+"//"+p.host+y)}else if(window.location.hash=this.fragment=y,this.iframe&&y!=this.getFragment(this.iframe.location.hash)){this.iframe.document.open().close();this.iframe.location.hash=y}h&&this.loadUrl(g)}}});K.View=function(g){this.cid=C.uniqueId("view");this._configure(g||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var k=/^(\S+)\s*(.*)$/,D=["model","collection","el","id","attributes",
"className","tagName"];C.extend(K.View.prototype,K.Events,{tagName:"div",$:function(g){return W(g,this.el)},initialize:function(){},render:function(){return this},remove:function(){W(this.el).remove();return this},make:function(g,h,y){g=document.createElement(g);h&&W(g).attr(h);y&&W(g).html(y);return g},delegateEvents:function(g){if(g||(g=this.events))for(var h in C.isFunction(g)&&(g=g.call(this)),W(this.el).unbind(".delegateEvents"+this.cid),g){var y=this[g[h]];if(!y)throw Error('Event "'+g[h]+'" does not exist');
var p=h.match(k),m=p[1];p=p[2];y=C.bind(y,this);m+=".delegateEvents"+this.cid;p===""?W(this.el).bind(m,y):W(this.el).delegate(p,m,y)}},_configure:function(g){this.options&&(g=C.extend({},this.options,g));for(var h=0,y=D.length;h<y;h++){var p=D[h];g[p]&&(this[p]=g[p])}this.options=g},_ensureElement:function(){if(this.el){if(C.isString(this.el))this.el=W(this.el).get(0)}else{var g=this.attributes||{};if(this.id)g.id=this.id;if(this.className)g["class"]=this.className;this.el=this.make(this.tagName,
g)}}});K.Model.extend=K.Collection.extend=K.Router.extend=K.View.extend=function(g,h){var y=o(this,g,h);y.extend=this.extend;return y};var H={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};K.sync=function(g,h,y){var p=H[g];y=C.extend({type:p,dataType:"json"},y);if(!y.url)y.url=v(h)||E();if(!y.data&&h&&(g=="create"||g=="update")){y.contentType="application/json";y.data=JSON.stringify(h.toJSON())}if(K.emulateJSON){y.contentType="application/x-www-form-urlencoded";y.data=y.data?{model:y.data}:
{}}if(K.emulateHTTP&&(p==="PUT"||p==="DELETE")){if(K.emulateJSON)y.data._method=p;y.type="POST";y.beforeSend=function(m){m.setRequestHeader("X-HTTP-Method-Override",p)}}if(y.type!=="GET"&&!K.emulateJSON)y.processData=false;return W.ajax(y)};var L=function(){},o=function(g,h,y){var p;p=h&&h.hasOwnProperty("constructor")?h.constructor:function(){return g.apply(this,arguments)};C.extend(p,g);L.prototype=g.prototype;p.prototype=new L;h&&C.extend(p.prototype,h);y&&C.extend(p,y);p.prototype.constructor=
p;p.__super__=g.prototype;return p},v=function(g){if(!g||!g.url)return null;return C.isFunction(g.url)?g.url():g.url},E=function(){throw Error('A "url" property or function must be specified');},P=function(g,h,y){return function(p){g?g(h,p,y):h.trigger("error",h,p,y)}}}).call(this);/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(l){function U(m,x,B,F){F={data:F||F===0||F===false?F:x?x.data:{},_wrap:x?x._wrap:null,tmpl:null,parent:x||null,nodes:[],calls:u,nest:T,wrap:J,html:k,update:D};m&&l.extend(F,m,{nodes:[],parent:x});if(B){F.tmpl=B;F._ctnt=F._ctnt||F.tmpl(l,F);F.key=++h;(p.length?E:v)[h]=F}return F}function K(m,x,B){var F;B=B?l.map(B,function(Q){return typeof Q==="string"?m.key?Q.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+L+'="'+m.key+'" $2'):Q:K(Q,m,Q._ctnt)}):m;if(x)return B;B=B.join("");B.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(Q,i,q,z){F=l(q).get();R(F);if(i)F=C(i).concat(F);if(z)F=F.concat(C(z))});return F?F:C(B)}function C(m){var x=document.createElement("div");x.innerHTML=m;return l.makeArray(x.childNodes)}function W(m){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+l.trim(m).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(x,B,F,Q,i,q,z){x=l.tmpl.tag[F];if(!x)throw"Unknown template tag: "+F;F=x._default||[];if(q&&!/\w$/.test(i)){i+=q;q=""}if(i){i=S(i);z=z?","+S(z)+")":q?")":"";z=q?i.indexOf(".")>-1?i+S(q):"("+i+").call($item"+z:i;q=q?z:"(typeof("+i+")==='function'?("+i+").call($item):("+i+"))"}else q=z=F.$1||"null";Q=S(Q);return"');"+x[B?"close":"open"].split("$notnull_1").join(i?"typeof("+i+")!=='undefined' && ("+i+")!=null":"true").split("$1a").join(q).split("$1").join(z).split("$2").join(Q||F.$2||"")+"__.push('"})+
"');}return __;")}function A(m,x){m._wrap=K(m,true,l.isArray(x)?x:[o.test(x)?x:l(x).html()]).join("")}function S(m){return m?m.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function R(m){function x(O){function Z(ia){ia+=B;ga=i[ia]=i[ia]||U(ga,v[ga.parent.key+B]||ga.parent)}var ha,ca=O,ga,ma;if(ma=O.getAttribute(L)){for(;ca.parentNode&&(ca=ca.parentNode).nodeType===1&&!(ha=ca.getAttribute(L)););if(ha!==ma){ca=ca.parentNode?ca.nodeType===11?0:ca.getAttribute(L)||0:0;if(!(ga=v[ma])){ga=E[ma];ga=U(ga,
v[ca]||E[ca]);ga.key=++h;v[h]=ga}y&&Z(ma)}O.removeAttribute(L)}else if(y&&(ga=l.data(O,"tmplItem"))){Z(ga.key);v[ga.key]=ga;ca=(ca=l.data(O.parentNode,"tmplItem"))?ca.key:0}if(ga){for(ha=ga;ha&&ha.key!=ca;){ha.nodes.push(O);ha=ha.parent}delete ga._ctnt;delete ga._wrap;l.data(O,"tmplItem",ga)}}var B="_"+y,F,Q,i={},q,z,G;q=0;for(z=m.length;q<z;q++)if((F=m[q]).nodeType===1){Q=F.getElementsByTagName("*");for(G=Q.length-1;G>=0;G--)x(Q[G]);x(F)}}function u(m,x,B,F){if(!m)return p.pop();p.push({_:m,tmpl:x,
item:this,data:B,options:F})}function T(m,x,B){return l.tmpl(l.template(m),x,B,this)}function J(m,x){var B=m.options||{};B.wrapped=x;return l.tmpl(l.template(m.tmpl),m.data,B,m.item)}function k(m,x){var B=this._wrap;return l.map(l(l.isArray(B)?B.join(""):B).filter(m||"*"),function(F){if(x)F=F.innerText||F.textContent;else{var Q;if(!(Q=F.outerHTML)){Q=document.createElement("div");Q.appendChild(F.cloneNode(true));Q=Q.innerHTML}F=Q}return F})}function D(){var m=this.nodes;l.tmpl(null,null,null,this).insertBefore(m[0]);
l(m).remove()}var H=l.fn.domManip,L="_tmplitem",o=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,v={},E={},P,g={key:0,data:{}},h=0,y=0,p=[];l.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(m,x){l.fn[m]=function(B){var F=[];B=l(B);var Q,i,q;Q=this.length===1&&this[0].parentNode;P=v||{};if(Q&&Q.nodeType===11&&Q.childNodes.length===1&&B.length===1){B[x](this[0]);F=this}else{i=0;for(q=B.length;i<q;i++){y=i;Q=(i>0?this.clone(true):this).get();
l(B[i])[x](Q);F=F.concat(Q)}y=0;F=this.pushStack(F,m,B.selector)}B=P;P=null;l.tmpl.complete(B);return F}});l.fn.extend({tmpl:function(m,x,B){return l.tmpl(this[0],m,x,B)},tmplItem:function(){return l.tmplItem(this[0])},template:function(m){return l.template(m,this[0])},domManip:function(m,x,B){if(m[0]&&l.isArray(m[0])){for(var F=l.makeArray(arguments),Q=m[0],i=Q.length,q=0,z;q<i&&!(z=l.data(Q[q++],"tmplItem")););if(z&&y)F[2]=function(G){l.tmpl.afterManip(this,G,B)};H.apply(this,F)}else H.apply(this,
arguments);y=0;P||l.tmpl.complete(v);return this}});l.extend({tmpl:function(m,x,B,F){var Q=!F;if(Q){F=g;m=l.template[m]||l.template(null,m);E={}}else if(!m){m=F.tmpl;v[F.key]=F;F.nodes=[];F.wrapped&&A(F,F.wrapped);return l(K(F,null,F.tmpl(l,F)))}if(!m)return[];if(typeof x==="function")x=x.call(F||{});B&&B.wrapped&&A(B,B.wrapped);x=l.isArray(x)?l.map(x,function(i){return i?U(B,F,m,i):null}):[U(B,F,m,x)];return Q?l(K(F,null,x)):x},tmplItem:function(m){var x;if(m instanceof l)m=m[0];for(;m&&m.nodeType===
1&&!(x=l.data(m,"tmplItem"))&&(m=m.parentNode););return x||g},template:function(m,x){if(x){if(typeof x==="string")x=W(x);else if(x instanceof l)x=x[0]||{};if(x.nodeType)x=l.data(x,"tmpl")||l.data(x,"tmpl",W(x.innerHTML));return typeof m==="string"?l.template[m]=x:x}return m?typeof m!=="string"?l.template(null,m):l.template[m]||l.template(null,o.test(m)?m:l(m)):null},encode:function(m){return(""+m).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
l.extend(l.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},
"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){v={}},afterManip:function(m,x,B){var F=x.nodeType===11?l.makeArray(x.childNodes):x.nodeType===1?[x]:[];B.call(m,x);R(F);y++}})})(jQuery);/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function l(D){if(A&&(S||!C||!C.log))A.apply(U,D)}for(var U=this,K=Array.prototype.slice,C=U.console,W={},A,S,R=9,u=["error","warn","info","debug","log"],T="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),J=T.length,k=[];--J>=0;)(function(D){W[D]=function(){R!==0&&C&&C[D]&&C[D].apply(C,arguments)}})(T[J]);for(J=u.length;--J>=0;)(function(D,H){W[H]=function(){var L=K.call(arguments),o=[H].concat(L);
k.push(o);l(o);if(C&&(R>0?R>D:u.length+R<=D))C.firebug?C[H].apply(U,L):C[H]?C[H](L):C.log(L)}})(J,u[J]);W.setLevel=function(D){R=typeof D==="number"?D:9};W.setCallback=function(){var D=K.call(arguments),H=k.length,L=H;A=D.shift()||null;S=typeof D[0]==="boolean"?D.shift():false;for(L-=typeof D[0]==="number"?D.shift():H;L<H;)l(k[L++])};return W}();(function(l){var U=l("<b/>");l.subscribe=function(K,C){function W(){return C.apply(this,Array.prototype.slice.call(arguments,1))}W.guid=C.guid=C.guid||(l.guid?l.guid++:l.event.guid++);U.bind(K,W)};l.unsubscribe=function(){U.unbind.apply(U,arguments)};l.publish=function(){U.trigger.apply(U,arguments)}})(jQuery);(function(l){function U(W){var A=W||window.event,S=[].slice.call(arguments,1),R=0,u=0,T=0;return W=l.event.fix(A),W.type="mousewheel",A.detail&&(R=-A.detail/3),A.wheelDeltaY!==undefined&&(T=A.wheelDeltaY/120),A.wheelDeltaX!==undefined&&(u=-1*A.wheelDeltaX/120),S.unshift(W,R,u,T),(l.event.dispatch||l.event.handle).apply(this,S)}var K=["DOMMouseScroll","mousewheel"];if(l.event.fixHooks)for(var C=K.length;C;)l.event.fixHooks[K[--C]]=l.event.mouseHooks;l.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var W=
K.length;W;)this.addEventListener(K[--W],U,false);else this.onmousewheel=U},teardown:function(){if(this.removeEventListener)for(var W=K.length;W;)this.removeEventListener(K[--W],U,false);else this.onmousewheel=null}};l.fn.extend({mousewheel:function(W){return W?this.bind("mousewheel",W):this.trigger("mousewheel")},unmousewheel:function(W){return this.unbind("mousewheel",W)}})})(jQuery);$(function(){$.extend($.support,{touch:"ontouchend"in document});$.fn.addTouch=function(){$.support.touch&&this.each(function(l,U){U.addEventListener("touchstart",iPadTouchHandler,false);U.addEventListener("touchmove",iPadTouchHandler,false);U.addEventListener("touchend",iPadTouchHandler,false);U.addEventListener("touchcancel",iPadTouchHandler,false)})}});var lastTap=null,tapValid=false,tapTimeout=null;function cancelTap(){tapValid=false}
var rightClickPending=false,rightClickEvent=null,holdTimeout=null,cancelMouseUp=false;function cancelHold(){if(rightClickPending){window.clearTimeout(holdTimeout);rightClickPending=false;rightClickEvent=null}}function startHold(l){if(!rightClickPending){rightClickPending=true;rightClickEvent=l.changedTouches[0];holdTimeout=window.setTimeout("doRightClick();",800)}}
function doRightClick(){rightClickPending=false;var l=rightClickEvent,U=document.createEvent("MouseEvent");U.initMouseEvent("mouseup",true,true,window,1,l.screenX,l.screenY,l.clientX,l.clientY,false,false,false,false,0,null);l.target.dispatchEvent(U);U=document.createEvent("MouseEvent");U.initMouseEvent("mousedown",true,true,window,1,l.screenX,l.screenY,l.clientX,l.clientY,false,false,false,false,2,null);l.target.dispatchEvent(U);U=document.createEvent("MouseEvent");U.initMouseEvent("contextmenu",
true,true,window,1,l.screenX+50,l.screenY+5,l.clientX+50,l.clientY+5,false,false,false,false,2,null);l.target.dispatchEvent(U);cancelMouseUp=true;rightClickEvent=null}
function iPadTouchStart(l){var U=l.changedTouches[0],K="mouseover",C=document.createEvent("MouseEvent");C.initMouseEvent(K,true,true,window,1,U.screenX,U.screenY,U.clientX,U.clientY,false,false,false,false,0,null);U.target.dispatchEvent(C);K="mousedown";C=document.createEvent("MouseEvent");C.initMouseEvent(K,true,true,window,1,U.screenX,U.screenY,U.clientX,U.clientY,false,false,false,false,0,null);U.target.dispatchEvent(C);if(tapValid){window.clearTimeout(tapTimeout);if(U.target==lastTap){lastTap=
null;tapValid=false;K="click";C=document.createEvent("MouseEvent");C.initMouseEvent(K,true,true,window,1,U.screenX,U.screenY,U.clientX,U.clientY,false,false,false,false,0,null);U.target.dispatchEvent(C);K="dblclick";C=document.createEvent("MouseEvent");C.initMouseEvent(K,true,true,window,1,U.screenX,U.screenY,U.clientX,U.clientY,false,false,false,false,0,null);U.target.dispatchEvent(C)}else{lastTap=U.target;tapValid=true;tapTimeout=window.setTimeout("cancelTap();",600);startHold(l)}}else{lastTap=
U.target;tapValid=true;tapTimeout=window.setTimeout("cancelTap();",600);startHold(l)}}
function iPadTouchHandler(l){var U="";if(!(l.touches.length>1)){switch(l.type){case "touchstart":if($(l.changedTouches[0].target).is("select"))return;iPadTouchStart(l);l.preventDefault();return false;case "touchmove":cancelHold();U="mousemove";l.preventDefault();break;case "touchend":if(cancelMouseUp){cancelMouseUp=false;l.preventDefault();return false}cancelHold();U="mouseup";break;default:return}l=l.changedTouches[0];var K=document.createEvent("MouseEvent");K.initMouseEvent(U,true,true,window,1,
l.screenX,l.screenY,l.clientX,l.clientY,false,false,false,false,0,null);l.target.dispatchEvent(K);if(U=="mouseup"&&tapValid&&l.target==lastTap){K=document.createEvent("MouseEvent");K.initMouseEvent("click",true,true,window,1,l.screenX,l.screenY,l.clientX,l.clientY,false,false,false,false,0,null);l.target.dispatchEvent(K)}}};/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function l(){if(l.is(arguments[0],O)){for(var a=arguments[0],c=Oa[v](l,a.splice(0,3+l.is(a[0],G))),d=c.set(),f=0,j=a[m];f<j;f++){var e=a[f]||{};R[J](e.type)&&d[ca](c[e.type]().attr(e))}return d}return Oa[v](l,arguments)}function U(){for(var a=[],c=0;c<32;c++)a[c]=(~~(B.random()*16))[Z](16);a[12]=4;a[16]=(a[16]&3|8)[Z](16);return"r-"+a[p]("")}function K(a,c,d){function f(){var j=Array[T].slice.call(arguments,0),e=j[p]("\u25ba"),n=f.cache=f.cache||{},r=f.count=f.count||[];if(n[J](e))return d?
d(n[e]):n[e];r[m]>=1E3&&delete n[r.shift()];r[ca](e);n[e]=a[v](c,j);return d?d(n[e]):n[e]}return f}function C(){return this.x+P+this.y}function W(a){return function(c,d,f,j){var e={back:a};l.is(f,"function")?j=f:e.rot=f;c&&c.constructor==ka&&(c=c.attrs.path);c&&(e.along=c);return this.animate(e,d,j)}}function A(a,c,d,f,j,e){function n(X,fa){var Y,V,ba,la;ba=X;for(V=0;V<8;V++){la=((w*ba+s)*ba+r)*ba-X;if(i(la)<fa)return ba;Y=(3*w*ba+2*s)*ba+r;if(i(Y)<1.0E-6)break;ba-=la/Y}Y=0;V=1;ba=X;if(ba<Y)return Y;
if(ba>V)return V;for(;Y<V;){la=((w*ba+s)*ba+r)*ba;if(i(la-X)<fa)break;X>la?Y=ba:V=ba;ba=(V-Y)/2+Y}return ba}var r=3*c,s=3*(f-c)-r,w=1-r-s,I=3*d,M=3*(j-d)-I,N=1-I-M;return function(X,fa){var Y=n(X,fa);return((N*Y+M)*Y+I)*Y}(a,1/(200*e))}l.version="1.5.2";var S=/[, ]+/,R={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},u=/\{(\d+)\}/g,T="prototype",J="hasOwnProperty",k=document,D=window,H={was:Object[T][J].call(D,"Raphael"),is:D.Raphael},L=function(){this.customAttributes={}},o,v="apply",E="createTouch"in
k,P=" ",g=String,h="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(P),y={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},p="join",m="length",x=g[T].toLowerCase,B=Math,F=B.max,Q=B.min,i=B.abs,q=B.pow,z=B.PI,G="number",O="array",Z="toString",ha=Object[T][Z],ca="push",ga=/^url\(['"]?([^\)]+?)['"]?\)$/i,ma=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
ia={NaN:1,Infinity:1,"-Infinity":1},sa=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,da=B.round,aa=parseFloat,oa=parseInt,xa=g[T].toUpperCase,Fa={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Pa={along:"along",blur:G,"clip-rect":"csv",cx:G,cy:G,fill:"colour","fill-opacity":G,"font-size":G,height:G,opacity:G,path:"path",r:G,rotation:"csv",rx:G,ry:G,scale:"csv",stroke:"colour","stroke-opacity":G,"stroke-width":G,translation:"csv",width:G,x:G,y:G},vb=/^(from|to|\d+%?)$/,Qa=/\s*,\s*/,wb={hs:1,rg:1},xb=/,?([achlmqrstvxz]),?/gi,
yb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,Ab=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,$a=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,Bb=function(a,c){return a.key-c.key};l.type=D.SVGAngle||k.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(l.type=="VML"){var ua=k.createElement("div");ua.innerHTML='<v:shape adj="1"/>';ua=ua.firstChild;ua.style.behavior="url(#default#VML)";if(!(ua&&typeof ua.adj=="object"))return l.type=null;ua=null}l.svg=
!(l.vml=l.type=="VML");L[T]=l[T];o=L[T];l._id=0;l._oid=0;l.fn={};l.is=function(a,c){c=x.call(c);if(c=="finite")return!ia[J](+a);return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||ha.call(a).slice(8,-1).toLowerCase()==c};l.angle=function(a,c,d,f,j,e){if(j==null){a-=d;c-=f;if(!a&&!c)return 0;return((a<0)*180+B.atan(-c/-a)*180/z+360)%360}return l.angle(a,c,j,e)-l.angle(d,f,j,e)};l.rad=function(a){return a%360*z/180};l.deg=function(a){return a*
180/z%360};l.snapTo=function(a,c,d){d=l.is(d,"finite")?d:10;if(l.is(a,O))for(var f=a.length;f--;){if(i(a[f]-c)<=d)return a[f]}else{a=+a;f=c%a;if(f<d)return c-f;if(f>a-d)return c-f+a}return c};l.setWindow=function(a){D=a;k=D.document};var Ga=function(a){if(l.vml){var c=/^\s+|\s+$/g,d;try{var f=new ActiveXObject("htmlfile");f.write("<body>");f.close();d=f.body}catch(j){d=createPopup().document.body}var e=d.createTextRange();Ga=K(function(r){try{d.style.color=g(r).replace(c,"");var s=e.queryCommandValue("ForeColor");
return"#"+("000000"+((s&255)<<16|s&65280|(s&16711680)>>>16)[Z](16)).slice(-6)}catch(w){return"none"}})}else{var n=k.createElement("i");n.title="Rapha\u00ebl Colour Picker";n.style.display="none";k.body.appendChild(n);Ga=K(function(r){n.style.color=r;return k.defaultView.getComputedStyle(n,"").getPropertyValue("color")})}return Ga(a)},ab=function(){return"hsb("+[this.h,this.s,this.b]+")"},Cb=function(){return"hsl("+[this.h,this.s,this.l]+")"},Db=function(){return this.hex};l.hsb2rgb=function(a,c,d,
f){if(l.is(a,"object")&&"h"in a&&"s"in a&&"b"in a){d=a.b;c=a.s;a=a.h;f=a.o}return l.hsl2rgb(a,c,d/2,f)};l.hsl2rgb=function(a,c,d,f){if(l.is(a,"object")&&"h"in a&&"s"in a&&"l"in a){d=a.l;c=a.s;a=a.h}if(a>1||c>1||d>1){a/=360;c/=100;d/=100}var j={},e=["r","g","b"],n;if(c){d<0.5?n=d*(1+c):n=d+c-d*c;c=2*d-n;for(var r=0;r<3;r++){d=a+1/3*-(r-1);d<0&&d++;d>1&&d--;d*6<1?j[e[r]]=c+(n-c)*6*d:d*2<1?j[e[r]]=n:d*3<2?j[e[r]]=c+(n-c)*(2/3-d)*6:j[e[r]]=c}}else j={r:d,g:d,b:d};j.r*=255;j.g*=255;j.b*=255;j.hex="#"+
(16777216|j.b|j.g<<8|j.r<<16).toString(16).slice(1);l.is(f,"finite")&&(j.opacity=f);j.toString=Db;return j};l.rgb2hsb=function(a,c,d){if(c==null&&l.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&l.is(a,"string")){d=l.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=F(a,c,d),j=Q(a,c,d),e;if(j==f)return{h:0,s:0,b:f,toString:ab};j=f-j;a==f?e=(c-d)/j:c==f?e=2+(d-a)/j:e=4+(a-c)/j;e/=6;e<0&&e++;e>1&&e--;return{h:e,s:j/f,b:f,toString:ab}};l.rgb2hsl=function(a,
c,d){if(c==null&&l.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&l.is(a,"string")){d=l.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=F(a,c,d),j=Q(a,c,d),e,n=(f+j)/2;if(j==f)a={h:0,s:0,l:n};else{var r=f-j;a==f?e=(c-d)/r:c==f?e=2+(d-a)/r:e=4+(a-c)/r;e/=6;e<0&&e++;e>1&&e--;a={h:e,s:n<0.5?r/(f+j):r/(2-f-j),l:n}}a.toString=Cb;return a};l._path2string=function(){return this.join(",").replace(xb,"$1")};l.getRGB=K(function(a){if(!a||(a=g(a)).indexOf("-")+
1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(wb[J](a.toLowerCase().substring(0,2))||a.charAt()=="#")&&(a=Ga(a));var c,d,f,j,e;if(a=a.match(ma)){if(a[2]){f=oa(a[2].substring(5),16);d=oa(a[2].substring(3,5),16);c=oa(a[2].substring(1,3),16)}if(a[3]){f=oa((e=a[3].charAt(3))+e,16);d=oa((e=a[3].charAt(2))+e,16);c=oa((e=a[3].charAt(1))+e,16)}if(a[4]){e=a[4].split(Qa);c=aa(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=aa(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=aa(e[2]);
e[2].slice(-1)=="%"&&(f*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(j=aa(e[3]));e[3]&&e[3].slice(-1)=="%"&&(j/=100)}if(a[5]){e=a[5].split(Qa);c=aa(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=aa(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=aa(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(j=aa(e[3]));e[3]&&e[3].slice(-1)=="%"&&(j/=100);return l.hsb2rgb(c,d,f,j)}if(a[6]){e=a[6].split(Qa);c=aa(e[0]);e[0].slice(-1)=="%"&&
(c*=2.55);d=aa(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=aa(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(j=aa(e[3]));e[3]&&e[3].slice(-1)=="%"&&(j/=100);return l.hsl2rgb(c,d,f,j)}a={r:c,g:d,b:f};a.hex="#"+(16777216|f|d<<8|c<<16).toString(16).slice(1);l.is(j,"finite")&&(a.opacity=j);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},l);l.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,
b:a||0.75};var c=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;if(a.h>1){a.h=0;a.s-=0.2;a.s<=0&&(this.getColor.start={h:0,s:1,b:a.b})}return c.hex};l.getColor.reset=function(){delete this.start};l.parsePathString=K(function(a){if(!a)return null;var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];l.is(a,O)&&l.is(a[0],O)&&(d=Ha(a));d[m]||g(a).replace(yb,function(f,j,e){var n=[];f=x.call(j);e.replace(Ab,function(r,s){s&&n[ca](+s)});if(f=="m"&&n[m]>2){d[ca]([j].concat(n.splice(0,2)));f="l";j=j=="m"?"l":"L"}for(;n[m]>=
c[f];){d[ca]([j].concat(n.splice(0,c[f])));if(!c[f])break}});d[Z]=l._path2string;return d});l.findDotsAtSegment=function(a,c,d,f,j,e,n,r,s){var w=1-s,I=q(w,3)*a+q(w,2)*3*s*d+w*3*s*s*j+q(s,3)*n;w=q(w,3)*c+q(w,2)*3*s*f+w*3*s*s*e+q(s,3)*r;var M=a+2*s*(d-a)+s*s*(j-2*d+a),N=c+2*s*(f-c)+s*s*(e-2*f+c),X=d+2*s*(j-d)+s*s*(n-2*j+d),fa=f+2*s*(e-f)+s*s*(r-2*e+f);a=(1-s)*a+s*d;c=(1-s)*c+s*f;j=(1-s)*j+s*n;e=(1-s)*e+s*r;r=90-B.atan((M-X)/(N-fa))*180/z;(M>X||N<fa)&&(r+=180);return{x:I,y:w,m:{x:M,y:N},n:{x:X,y:fa},
start:{x:a,y:c},end:{x:j,y:e},alpha:r}};var Ja=K(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Ia(a);for(var c=0,d=0,f=[],j=[],e,n=0,r=a[m];n<r;n++){e=a[n];if(e[0]=="M"){c=e[1];d=e[2];f[ca](c);j[ca](d)}else{c=Eb(c,d,e[1],e[2],e[3],e[4],e[5],e[6]);f=f.concat(c.min.x,c.max.x);j=j.concat(c.min.y,c.max.y);c=e[5];d=e[6]}}a=Q[v](0,f);e=Q[v](0,j);return{x:a,y:e,width:F[v](0,f)-a,height:F[v](0,j)-e}}),Ha=function(a){var c=[];if(!l.is(a,O)||!l.is(a&&a[0],O))a=l.parsePathString(a);for(var d=0,f=a[m];d<
f;d++){c[d]=[];for(var j=0,e=a[d][m];j<e;j++)c[d][j]=a[d][j]}c[Z]=l._path2string;return c},Ra=K(function(a){if(!l.is(a,O)||!l.is(a&&a[0],O))a=l.parsePathString(a);var c=[],d=0,f=0,j=0,e=0,n=0;if(a[0][0]=="M"){d=a[0][1];f=a[0][2];j=d;e=f;n++;c[ca](["M",d,f])}for(var r=a[m];n<r;n++){var s=c[n]=[],w=a[n];if(w[0]!=x.call(w[0])){s[0]=x.call(w[0]);switch(s[0]){case "a":s[1]=w[1];s[2]=w[2];s[3]=w[3];s[4]=w[4];s[5]=w[5];s[6]=+(w[6]-d).toFixed(3);s[7]=+(w[7]-f).toFixed(3);break;case "v":s[1]=+(w[1]-f).toFixed(3);
break;case "m":j=w[1];e=w[2];default:for(var I=1,M=w[m];I<M;I++)s[I]=+(w[I]-(I%2?d:f)).toFixed(3)}}else{c[n]=[];if(w[0]=="m"){j=w[1]+d;e=w[2]+f}s=0;for(I=w[m];s<I;s++)c[n][s]=w[s]}w=c[n][m];switch(c[n][0]){case "z":d=j;f=e;break;case "h":d+=+c[n][w-1];break;case "v":f+=+c[n][w-1];break;default:d+=+c[n][w-2];f+=+c[n][w-1]}}c[Z]=l._path2string;return c},0,Ha),Ba=K(function(a){if(!l.is(a,O)||!l.is(a&&a[0],O))a=l.parsePathString(a);var c=[],d=0,f=0,j=0,e=0,n=0;if(a[0][0]=="M"){d=+a[0][1];f=+a[0][2];j=
d;e=f;n++;c[0]=["M",d,f]}for(var r=a[m];n<r;n++){var s=c[n]=[],w=a[n];if(w[0]!=xa.call(w[0])){s[0]=xa.call(w[0]);switch(s[0]){case "A":s[1]=w[1];s[2]=w[2];s[3]=w[3];s[4]=w[4];s[5]=w[5];s[6]=+(w[6]+d);s[7]=+(w[7]+f);break;case "V":s[1]=+w[1]+f;break;case "H":s[1]=+w[1]+d;break;case "M":j=+w[1]+d;e=+w[2]+f;default:for(var I=1,M=w[m];I<M;I++)s[I]=+w[I]+(I%2?d:f)}}else{I=0;for(M=w[m];I<M;I++)c[n][I]=w[I]}switch(s[0]){case "Z":d=j;f=e;break;case "H":d=s[1];break;case "V":f=s[1];break;case "M":j=c[n][c[n][m]-
2];e=c[n][c[n][m]-1];default:d=c[n][c[n][m]-2];f=c[n][c[n][m]-1]}}c[Z]=l._path2string;return c},null,Ha),bb=function(a,c,d,f,j,e){var n=1/3,r=2/3;return[n*a+r*d,n*c+r*f,n*j+r*d,n*e+r*f,j,e]},cb=function(a,c,d,f,j,e,n,r,s,w){var I=z*120/180,M=z/180*(+j||0),N=[],X,fa=K(function(pa,qa,na){var za=pa*B.cos(na)-qa*B.sin(na);pa=pa*B.sin(na)+qa*B.cos(na);return{x:za,y:pa}});if(w){ba=w[0];X=w[1];e=w[2];V=w[3]}else{X=fa(a,c,-M);a=X.x;c=X.y;X=fa(r,s,-M);r=X.x;s=X.y;B.cos(z/180*j);B.sin(z/180*j);X=(a-r)/2;ba=
(c-s)/2;V=X*X/(d*d)+ba*ba/(f*f);if(V>1){V=B.sqrt(V);d*=V;f*=V}V=d*d;var Y=f*f;V=(e==n?-1:1)*B.sqrt(i((V*Y-V*ba*ba-Y*X*X)/(V*ba*ba+Y*X*X)));e=V*d*ba/f+(a+r)/2;var V=V*-f*X/d+(c+s)/2,ba=B.asin(((c-V)/f).toFixed(9));X=B.asin(((s-V)/f).toFixed(9));ba=a<e?z-ba:ba;X=r<e?z-X:X;ba<0&&(ba=z*2+ba);X<0&&(X=z*2+X);n&&ba>X&&(ba-=z*2);!n&&X>ba&&(X-=z*2)}if(i(X-ba)>I){N=X;Y=r;var la=s;X=ba+I*(n&&X>ba?1:-1);r=e+d*B.cos(X);s=V+f*B.sin(X);N=cb(r,s,d,f,j,0,n,Y,la,[X,N,e,V])}e=X-ba;j=B.cos(ba);I=B.sin(ba);n=B.cos(X);
X=B.sin(X);e=B.tan(e/4);d=4/3*d*e;e*=4/3*f;f=[a,c];a=[a+d*I,c-e*j];c=[r+d*X,s-e*n];r=[r,s];a[0]=2*f[0]-a[0];a[1]=2*f[1]-a[1];if(w)return[a,c,r].concat(N);N=[a,c,r].concat(N)[p]().split(",");w=[];r=0;for(s=N[m];r<s;r++)w[r]=r%2?fa(N[r-1],N[r],M).y:fa(N[r],N[r+1],M).x;return w},Ka=function(a,c,d,f,j,e,n,r,s){var w=1-s;return{x:q(w,3)*a+q(w,2)*3*s*d+w*3*s*s*j+q(s,3)*n,y:q(w,3)*c+q(w,2)*3*s*f+w*3*s*s*e+q(s,3)*r}},Eb=K(function(a,c,d,f,j,e,n,r){var s=j-2*d+a-(n-2*j+d),w=2*(d-a)-2*(j-d),I=a-d,M=(-w+B.sqrt(w*
w-4*s*I))/2/s;s=(-w-B.sqrt(w*w-4*s*I))/2/s;var N=[c,r],X=[a,n];i(M)>"1e12"&&(M=0.5);i(s)>"1e12"&&(s=0.5);if(M>0&&M<1){M=Ka(a,c,d,f,j,e,n,r,M);X[ca](M.x);N[ca](M.y)}if(s>0&&s<1){M=Ka(a,c,d,f,j,e,n,r,s);X[ca](M.x);N[ca](M.y)}s=e-2*f+c-(r-2*e+f);w=2*(f-c)-2*(e-f);I=c-f;M=(-w+B.sqrt(w*w-4*s*I))/2/s;s=(-w-B.sqrt(w*w-4*s*I))/2/s;i(M)>"1e12"&&(M=0.5);i(s)>"1e12"&&(s=0.5);if(M>0&&M<1){M=Ka(a,c,d,f,j,e,n,r,M);X[ca](M.x);N[ca](M.y)}if(s>0&&s<1){M=Ka(a,c,d,f,j,e,n,r,s);X[ca](M.x);N[ca](M.y)}return{min:{x:Q[v](0,
X),y:Q[v](0,N)},max:{x:F[v](0,X),y:F[v](0,N)}}}),Ia=K(function(a,c){var d=Ba(a),f=c&&Ba(c),j={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},n=function(Y,V){var ba,la;if(!Y)return["C",V.x,V.y,V.x,V.y,V.x,V.y];!(Y[0]in{T:1,Q:1})&&(V.qx=V.qy=null);switch(Y[0]){case "M":V.X=Y[1];V.Y=Y[2];break;case "A":Y=["C"].concat(cb[v](0,[V.x,V.y].concat(Y.slice(1))));break;case "S":ba=V.x+(V.x-(V.bx||V.x));la=V.y+(V.y-(V.by||V.y));Y=["C",ba,la].concat(Y.slice(1));break;
case "T":V.qx=V.x+(V.x-(V.qx||V.x));V.qy=V.y+(V.y-(V.qy||V.y));Y=["C"].concat(bb(V.x,V.y,V.qx,V.qy,Y[1],Y[2]));break;case "Q":V.qx=Y[1];V.qy=Y[2];Y=["C"].concat(bb(V.x,V.y,Y[1],Y[2],Y[3],Y[4]));break;case "L":Y=["C"].concat([V.x,V.y,Y[1],Y[2],Y[1],Y[2]]);break;case "H":Y=["C"].concat([V.x,V.y,Y[1],V.y,Y[1],V.y]);break;case "V":Y=["C"].concat([V.x,V.y,V.x,Y[1],V.x,Y[1]]);break;case "Z":Y=["C"].concat([V.x,V.y,V.X,V.Y,V.X,V.Y])}return Y},r=function(Y,V){if(Y[V][m]>7){Y[V].shift();for(var ba=Y[V];ba[m];)Y.splice(V++,
0,["C"].concat(ba.splice(0,6)));Y.splice(V,1);I=F(d[m],f&&f[m]||0)}},s=function(Y,V,ba,la,pa){if(Y&&V&&Y[pa][0]=="M"&&V[pa][0]!="M"){V.splice(pa,0,["M",la.x,la.y]);ba.bx=0;ba.by=0;ba.x=Y[pa][1];ba.y=Y[pa][2];I=F(d[m],f&&f[m]||0)}},w=0,I=F(d[m],f&&f[m]||0);for(;w<I;w++){d[w]=n(d[w],j);r(d,w);f&&(f[w]=n(f[w],e));f&&r(f,w);s(d,f,j,e,w);s(f,d,e,j,w);var M=d[w],N=f&&f[w],X=M[m],fa=f&&N[m];j.x=M[X-2];j.y=M[X-1];j.bx=aa(M[X-4])||j.x;j.by=aa(M[X-3])||j.y;e.bx=f&&(aa(N[fa-4])||e.x);e.by=f&&(aa(N[fa-3])||e.y);
e.x=f&&N[fa-2];e.y=f&&N[fa-1]}return f?[d,f]:d},null,Ha),db=K(function(a){for(var c=[],d=0,f=a[m];d<f;d++){var j={},e=a[d].match(/^([^:]*):?([\d\.]*)/);j.color=l.getRGB(e[1]);if(j.color.error)return null;j.color=j.color.hex;e[2]&&(j.offset=e[2]+"%");c[ca](j)}d=1;for(f=c[m]-1;d<f;d++)if(!c[d].offset){a=aa(c[d-1].offset||0);e=0;for(j=d+1;j<f;j++)if(c[j].offset){e=c[j].offset;break}if(!e){e=100;j=f}e=aa(e);for(e=(e-a)/(j-d+1);d<j;d++){a+=e;c[d].offset=a+"%"}}return c}),eb=function(a,c,d,f){if(l.is(a,
"string")||l.is(a,"object")){a=l.is(a,"string")?k.getElementById(a):a;if(a.tagName)return c==null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:c,height:d}}else return{container:1,x:a,y:c,width:d,height:f}},Sa=function(a,c){var d=this,f;for(f in c)if(c[J](f)&&!(f in a))switch(typeof c[f]){case "function":(function(j){a[f]=a===d?j:function(){return j[v](d,arguments)}})(c[f]);break;case "object":a[f]=a[f]||{};Sa.call(this,a[f],c[f]);
break;default:a[f]=c[f]}},Aa=function(a,c){a==c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},fb=function(a,c){if(c.top!==a){Aa(a,c);a.next=null;a.prev=c.top;c.top.next=a;c.top=a}},gb=function(a,c){if(c.bottom!==a){Aa(a,c);a.next=c.bottom;a.prev=null;c.bottom.prev=a;c.bottom=a}},hb=function(a,c,d){Aa(a,d);c==d.top&&(d.top=a);c.next&&(c.next.prev=a);a.next=c.next;a.prev=c;c.next=a},ib=function(a,c,d){Aa(a,d);c==d.bottom&&(d.bottom=a);
c.prev&&(c.prev.next=a);a.prev=c.prev;c.prev=a;a.next=c},jb=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+a+"\u201d of removed object");}};l.pathToRelative=Ra;if(l.svg){o.svgns="http://www.w3.org/2000/svg";o.xlink="http://www.w3.org/1999/xlink";da=function(a){return+a+(~~a===a)*0.5};var ea=function(a,c){if(c)for(var d in c)c[J](d)&&a.setAttribute(d,g(c[d]));else{a=k.createElementNS(o.svgns,a);a.style.webkitTapHighlightColor="rgba(0,0,0,0)";return a}};l[Z]=
function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var kb=function(a,c){var d=ea("path");c.canvas&&c.canvas.appendChild(d);d=new ka(d,c);d.type="path";ya(d,{fill:"none",stroke:"#000",path:a});return d},Ca=function(a,c,d){var f="linear",j=0.5,e=0.5,n=a.style;c=g(c).replace($a,function(I,M,N){f="radial";if(M&&N){j=aa(M);e=aa(N);I=(e>0.5)*2-1;q(j-0.5,2)+q(e-0.5,2)>0.25&&(e=B.sqrt(0.25-q(j-0.5,2))*I+0.5)&&e!=0.5&&(e=e.toFixed(5)-1.0E-5*I)}return""});c=c.split(/\s*\-\s*/);
if(f=="linear"){var r=c.shift();r=-aa(r);if(isNaN(r))return null;r=[0,0,B.cos(r*z/180),B.sin(r*z/180)];var s=1/(F(i(r[2]),i(r[3]))||1);r[2]*=s;r[3]*=s;if(r[2]<0){r[0]=-r[2];r[2]=0}if(r[3]<0){r[1]=-r[3];r[3]=0}}c=db(c);if(!c)return null;s=a.getAttribute("fill");(s=s.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(k.getElementById(s[1]));s=ea(f+"Gradient");s.id=U();ea(s,f=="radial"?{fx:j,fy:e}:{x1:r[0],y1:r[1],x2:r[2],y2:r[3]});d.defs.appendChild(s);d=0;for(r=c[m];d<r;d++){var w=ea("stop");ea(w,{offset:c[d].offset?
c[d].offset:d?"100%":"0%","stop-color":c[d].color||"#fff"});s.appendChild(w)}ea(a,{fill:"url(#"+s.id+")",opacity:1,"fill-opacity":1});n.fill="";n.opacity=1;return n.fillOpacity=1},Ta=function(a){var c=a.getBBox();ea(a.pattern,{patternTransform:l.format("translate({0},{1})",c.x,c.y)})},ya=function(a,c){var d={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},f=a.node,j=a.attrs,e=a.rotate(),n=
function(fa,Y){if(Y=d[x.call(Y)]){for(var V=fa.attrs["stroke-width"]||"1",ba={round:V,square:V,butt:0}[fa.attrs["stroke-linecap"]||c["stroke-linecap"]]||0,la=[],pa=Y[m];pa--;)la[pa]=Y[pa]*V+(pa%2?1:-1)*ba;ea(f,{"stroke-dasharray":la[p](",")})}};c[J]("rotation")&&(e=c.rotation);var r=g(e).split(S);if(r.length-1){r[1]=+r[1];r[2]=+r[2]}else r=null;aa(e)&&a.rotate(0,true);for(var s in c)if(c[J](s))if(Fa[J](s)){var w=c[s];j[s]=w;switch(s){case "blur":a.blur(w);break;case "rotation":a.rotate(w,true);break;
case "href":case "title":case "target":var I=f.parentNode;if(x.call(I.tagName)!="a"){var M=ea("a");I.insertBefore(M,f);M.appendChild(f);I=M}s=="target"&&w=="blank"?I.setAttributeNS(a.paper.xlink,"show","new"):I.setAttributeNS(a.paper.xlink,s,w);break;case "cursor":f.style.cursor=w;break;case "clip-rect":I=g(w).split(S);if(I[m]==4){a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode);var N=ea("clipPath");M=ea("rect");N.id=U();ea(M,{x:I[0],y:I[1],width:I[2],height:I[3]});N.appendChild(M);
a.paper.defs.appendChild(N);ea(f,{"clip-path":"url(#"+N.id+")"});a.clip=M}if(!w){(w=k.getElementById(f.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,"")))&&w.parentNode.removeChild(w);ea(f,{"clip-path":""});delete a.clip}break;case "path":a.type=="path"&&ea(f,{d:w?j.path=Ba(w):"M0,0"});break;case "width":f.setAttribute(s,w);if(j.fx){s="x";w=j.x}else break;case "x":j.fx&&(w=-j.x-(j.width||0));case "rx":if(s=="rx"&&a.type=="rect")break;case "cx":r&&(s=="x"||s=="cx")&&(r[1]+=w-j[s]);f.setAttribute(s,
w);a.pattern&&Ta(a);break;case "height":f.setAttribute(s,w);if(j.fy){s="y";w=j.y}else break;case "y":j.fy&&(w=-j.y-(j.height||0));case "ry":if(s=="ry"&&a.type=="rect")break;case "cy":r&&(s=="y"||s=="cy")&&(r[2]+=w-j[s]);f.setAttribute(s,w);a.pattern&&Ta(a);break;case "r":a.type=="rect"?ea(f,{rx:w,ry:w}):f.setAttribute(s,w);break;case "src":a.type=="image"&&f.setAttributeNS(a.paper.xlink,"href",w);break;case "stroke-width":f.style.strokeWidth=w;f.setAttribute(s,w);j["stroke-dasharray"]&&n(a,j["stroke-dasharray"]);
break;case "stroke-dasharray":n(a,w);break;case "translation":w=g(w).split(S);w[0]=+w[0]||0;w[1]=+w[1]||0;if(r){r[1]+=w[0];r[2]+=w[1]}La.call(a,w[0],w[1]);break;case "scale":w=g(w).split(S);a.scale(+w[0]||1,+w[1]||+w[0]||1,isNaN(aa(w[2]))?null:+w[2],isNaN(aa(w[3]))?null:+w[3]);break;case "fill":if(I=g(w).match(ga)){N=ea("pattern");var X=ea("image");N.id=U();ea(N,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});ea(X,{x:0,y:0});X.setAttributeNS(a.paper.xlink,"href",I[1]);N.appendChild(X);w=
k.createElement("img");w.style.cssText="position:absolute;left:-9999em;top-9999em";w.onload=function(){ea(N,{width:this.offsetWidth,height:this.offsetHeight});ea(X,{width:this.offsetWidth,height:this.offsetHeight});k.body.removeChild(this);a.paper.safari()};k.body.appendChild(w);w.src=I[1];a.paper.defs.appendChild(N);f.style.fill="url(#"+N.id+")";ea(f,{fill:"url(#"+N.id+")"});a.pattern=N;a.pattern&&Ta(a);break}I=l.getRGB(w);if(I.error)if(({circle:1,ellipse:1}[J](a.type)||g(w).charAt()!="r")&&Ca(f,
w,a.paper)){j.gradient=w;j.fill="none";break}else{delete c.gradient;delete j.gradient;!l.is(j.opacity,"undefined")&&l.is(c.opacity,"undefined")&&ea(f,{opacity:j.opacity});!l.is(j["fill-opacity"],"undefined")&&l.is(c["fill-opacity"],"undefined")&&ea(f,{"fill-opacity":j["fill-opacity"]})}I[J]("opacity")&&ea(f,{"fill-opacity":I.opacity>1?I.opacity/100:I.opacity});case "stroke":I=l.getRGB(w);f.setAttribute(s,I.hex);s=="stroke"&&I[J]("opacity")&&ea(f,{"stroke-opacity":I.opacity>1?I.opacity/100:I.opacity});
break;case "gradient":(({circle:1,ellipse:1})[J](a.type)||g(w).charAt()!="r")&&Ca(f,w,a.paper);break;case "opacity":j.gradient&&!j[J]("stroke-opacity")&&ea(f,{"stroke-opacity":w>1?w/100:w});case "fill-opacity":if(j.gradient){if(I=k.getElementById(f.getAttribute("fill").replace(/^url\(#|\)$/g,""))){I=I.getElementsByTagName("stop");I[I[m]-1].setAttribute("stop-opacity",w)}break}default:s=="font-size"&&(w=oa(w,10)+"px");I=s.replace(/(\-.)/g,function(fa){return xa.call(fa.substring(1))});f.style[I]=w;
f.setAttribute(s,w)}}Fb(a,c);r?a.rotate(r.join(P)):aa(e)&&a.rotate(e,true)},Fb=function(a,c){if(!(a.type!="text"||!(c[J]("text")||c[J]("font")||c[J]("font-size")||c[J]("x")||c[J]("y")))){var d=a.attrs,f=a.node,j=f.firstChild?oa(k.defaultView.getComputedStyle(f.firstChild,"").getPropertyValue("font-size"),10):10;if(c[J]("text")){for(d.text=c.text;f.firstChild;)f.removeChild(f.firstChild);for(var e=g(c.text).split("\n"),n=0,r=e[m];n<r;n++)if(e[n]){var s=ea("tspan");n&&ea(s,{dy:j*1.2,x:d.x});s.appendChild(k.createTextNode(e[n]));
f.appendChild(s)}}else{e=f.getElementsByTagName("tspan");n=0;for(r=e[m];n<r;n++)n&&ea(e[n],{dy:j*1.2,x:d.x})}ea(f,{y:d.y});j=a.getBBox();(j=d.y-(j.y+j.height/2))&&l.is(j,"finite")&&ea(f,{y:d.y+j})}},ka=function(a,c){this[0]=a;this.id=l._oid++;this.node=a;a.raphael=this;this.paper=c;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},ja=ka[T];ka[T].rotate=function(a,
c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][p](P);return this._.rt.deg}var f=this.getBBox();a=g(a).split(S);if(a[m]-1){c=aa(a[1]);d=aa(a[2])}a=aa(a[0]);c!=null&&c!==false?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;c=c==null?f.x+f.width/2:c;d=d==null?f.y+f.height/2:d;if(this._.rt.deg){this.transformations[0]=l.format("rotate({0} {1} {2})",this._.rt.deg,c,d);this.clip&&ea(this.clip,{transform:l.format("rotate({0} {1} {2})",
-this._.rt.deg,c,d)})}else{this.transformations[0]="";this.clip&&ea(this.clip,{transform:""})}ea(this.node,{transform:this.transformations[p](P)});return this};ka[T].hide=function(){!this.removed&&(this.node.style.display="none");return this};ka[T].show=function(){!this.removed&&(this.node.style.display="");return this};ka[T].remove=function(){if(!this.removed){Aa(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=true}};ka[T].getBBox=function(){if(this.removed)return this;
if(this.type=="path")return Ja(this.attrs.path);if(this.node.style.display=="none"){this.show();var a=true}var c={};try{c=this.node.getBBox()}catch(d){}finally{c=c||{}}if(this.type=="text"){c={x:c.x,y:Infinity,width:0,height:0};for(var f=0,j=this.node.getNumberOfChars();f<j;f++){var e=this.node.getExtentOfChar(f);e.y<c.y&&(c.y=e.y);e.y+e.height-c.y>c.height&&(c.height=e.y+e.height-c.y);e.x+e.width-c.x>c.width&&(c.width=e.x+e.width-c.x)}}a&&this.hide();return c};ka[T].attr=function(a,c){if(this.removed)return this;
if(a==null){var d={},f;for(f in this.attrs)this.attrs[J](f)&&(d[f]=this.attrs[f]);this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&l.is(a,"string")){if(a=="translation")return La.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(c==
null&&l.is(a,O)){f={};d=0;for(var j=a.length;d<j;d++)f[a[d]]=this.attr(a[d]);return f}if(c!=null){d={};d[a]=c}else a!=null&&l.is(a,"object")&&(d=a);for(j in this.paper.customAttributes)if(this.paper.customAttributes[J](j)&&d[J](j)&&l.is(this.paper.customAttributes[j],"function")){f=this.paper.customAttributes[j].apply(this,[].concat(d[j]));this.attrs[j]=d[j];for(var e in f)f[J](e)&&(d[e]=f[e])}ya(this,d);return this};ka[T].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);
var a=this.paper;a.top!=this&&fb(this,a);return this};ka[T].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);gb(this,this.paper)}return this};ka[T].insertAfter=function(a){if(this.removed)return this;var c=a.node||a[a.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);hb(this,a,this.paper);return this};ka[T].insertBefore=
function(a){if(this.removed)return this;var c=a.node||a[0].node;c.parentNode.insertBefore(this.node,c);ib(this,a,this.paper);return this};ka[T].blur=function(a){if(+a!==0){var c=ea("filter"),d=ea("feGaussianBlur");this.attrs.blur=a;c.id=U();ea(d,{stdDeviation:+a||1.5});c.appendChild(d);this.paper.defs.appendChild(c);this._blur=c;ea(this.node,{filter:"url(#"+c.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};
var lb=function(a,c,d,f){var j=ea("circle");a.canvas&&a.canvas.appendChild(j);a=new ka(j,a);a.attrs={cx:c,cy:d,r:f,fill:"none",stroke:"#000"};a.type="circle";ea(j,a.attrs);return a},mb=function(a,c,d,f,j,e){var n=ea("rect");a.canvas&&a.canvas.appendChild(n);a=new ka(n,a);a.attrs={x:c,y:d,width:f,height:j,r:e||0,rx:e||0,ry:e||0,fill:"none",stroke:"#000"};a.type="rect";ea(n,a.attrs);return a},nb=function(a,c,d,f,j){var e=ea("ellipse");a.canvas&&a.canvas.appendChild(e);a=new ka(e,a);a.attrs={cx:c,cy:d,
rx:f,ry:j,fill:"none",stroke:"#000"};a.type="ellipse";ea(e,a.attrs);return a},ob=function(a,c,d,f,j,e){var n=ea("image");ea(n,{x:d,y:f,width:j,height:e,preserveAspectRatio:"none"});n.setAttributeNS(a.xlink,"href",c);a.canvas&&a.canvas.appendChild(n);a=new ka(n,a);a.attrs={x:d,y:f,width:j,height:e,src:c};a.type="image";return a},pb=function(a,c,d,f){var j=ea("text");ea(j,{x:c,y:d,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(j);a=new ka(j,a);a.attrs={x:c,y:d,"text-anchor":"middle",text:f,
font:Fa.font,stroke:"none",fill:"#000"};a.type="text";ya(a,a.attrs);return a},qb=function(a,c){this.width=a||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},Oa=function(){var a=eb[v](0,arguments),c=a&&a.container,d=a.x,f=a.y,j=a.width;a=a.height;if(!c)throw Error("SVG container not found.");var e=ea("svg");d=d||0;f=f||0;j=j||512;a=a||342;ea(e,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:j,height:a});
if(c==1){e.style.cssText="position:absolute;left:"+d+"px;top:"+f+"px";k.body.appendChild(e)}else c.firstChild?c.insertBefore(e,c.firstChild):c.appendChild(e);c=new L;c.width=j;c.height=a;c.canvas=e;Sa.call(c,c,l.fn);c.clear();return c};o.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=ea("desc")).appendChild(k.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=ea("defs"))};o.remove=function(){this.canvas.parentNode&&
this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=jb(a)}}if(l.vml){var rb={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Gb=/([clmz]),?([^clmz]*)/gi,Hb=/ progid:\S+Blur\([^\)]+\)/g,Ib=/-?[^,\s-]+/g,Da=1E3+P+1E3,Ea={path:1,rect:1},Jb=function(a){var c=/[ahqstv]/ig,d=Ba;g(a).match(c)&&(d=Ia);c=/[clmz]/g;if(d==Ba&&!g(a).match(c))return a=g(a).replace(Gb,function(s,w,I){var M=[],N=x.call(w)=="m",X=rb[w];I.replace(Ib,function(fa){if(N&&M[m]==2){X+=M+rb[w=="m"?"l":"L"];M=[]}M[ca](da(fa*
10))});return X+M});c=d(a);var f;a=[];for(var j=0,e=c[m];j<e;j++){d=c[j];f=x.call(c[j][0]);f=="z"&&(f="x");for(var n=1,r=d[m];n<r;n++)f+=da(d[n]*10)+(n!=r-1?",":"");a[ca](f)}return a[p](P)};l[Z]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};kb=function(a,c){var d=ra("group");d.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";d.coordsize=c.coordsize;d.coordorigin=c.coordorigin;var f=
ra("shape"),j=f.style;j.width=c.width+"px";j.height=c.height+"px";f.coordsize=Da;f.coordorigin=c.coordorigin;d.appendChild(f);f=new ka(f,d,c);j={fill:"none",stroke:"#000"};a&&(j.path=a);f.type="path";f.path=[];f.Path="";ya(f,j);c.canvas.appendChild(d);return f};ya=function(a,c){a.attrs=a.attrs||{};var d=a.node,f=a.attrs,j=d.style,e;e=(c.x!=f.x||c.y!=f.y||c.width!=f.width||c.height!=f.height||c.r!=f.r)&&a.type=="rect";for(var n in c)c[J](n)&&(f[n]=c[n]);if(e){f.path=sb(f.x,f.y,f.width,f.height,f.r);
a.X=f.x;a.Y=f.y;a.W=f.width;a.H=f.height}c.href&&(d.href=c.href);c.title&&(d.title=c.title);c.target&&(d.target=c.target);c.cursor&&(j.cursor=c.cursor);"blur"in c&&a.blur(c.blur);if(c.path&&a.type=="path"||e)d.path=Jb(f.path);c.rotation!=null&&a.rotate(c.rotation,true);if(c.translation){e=g(c.translation).split(S);La.call(a,e[0],e[1]);if(a._.rt.cx!=null){a._.rt.cx+=+e[0];a._.rt.cy+=+e[1];a.setBox(a.attrs,e[0],e[1])}}if(c.scale){e=g(c.scale).split(S);a.scale(+e[0]||1,+e[1]||+e[0]||1,+e[2]||null,+e[3]||
null)}if("clip-rect"in c){e=g(c["clip-rect"]).split(S);if(e[m]==4){e[2]=+e[2]+ +e[0];e[3]=+e[3]+ +e[1];n=d.clipRect||k.createElement("div");var r=n.style,s=d.parentNode;r.clip=l.format("rect({1}px {2}px {3}px {0}px)",e);if(!d.clipRect){r.position="absolute";r.top=0;r.left=0;r.width=a.paper.width+"px";r.height=a.paper.height+"px";s.parentNode.insertBefore(n,s);n.appendChild(s);d.clipRect=n}}c["clip-rect"]||d.clipRect&&(d.clipRect.style.clip="")}a.type=="image"&&c.src&&(d.src=c.src);if(a.type=="image"&&
c.opacity){d.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+c.opacity*100+")";j.filter=(d.filterMatrix||"")+(d.filterOpacity||"")}c.font&&(j.font=c.font);c["font-family"]&&(j.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');c["font-size"]&&(j.fontSize=c["font-size"]);c["font-weight"]&&(j.fontWeight=c["font-weight"]);c["font-style"]&&(j.fontStyle=c["font-style"]);if(c.opacity!=null||c["stroke-width"]!=null||c.fill!=null||c.stroke!=null||c["stroke-width"]!=
null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=null||c["stroke-miterlimit"]!=null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null){d=a.shape||d;e=d.getElementsByTagName("fill")&&d.getElementsByTagName("fill")[0];n=false;!e&&(n=e=ra("fill"));if("fill-opacity"in c||"opacity"in c){j=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+l.getRGB(c.fill).o+1||2)-1);j=Q(F(j,0),1);e.opacity=j}c.fill&&(e.on=true);if(e.on==null||c.fill=="none")e.on=false;if(e.on&&
c.fill)if(j=c.fill.match(ga)){e.src=j[1];e.type="tile"}else{e.color=l.getRGB(c.fill).hex;e.src="";e.type="solid";if(l.getRGB(c.fill).error&&(a.type in{circle:1,ellipse:1}||g(c.fill).charAt()!="r")&&Ca(a,c.fill)){f.fill="none";f.gradient=c.fill}}n&&d.appendChild(e);e=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0];n=false;!e&&(n=e=ra("stroke"));if(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||
c["stroke-linecap"])e.on=true;(c.stroke=="none"||e.on==null||c.stroke==0||c["stroke-width"]==0)&&(e.on=false);j=l.getRGB(c.stroke);e.on&&c.stroke&&(e.color=j.hex);j=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+j.o+1||2)-1);r=(aa(c["stroke-width"])||1)*0.75;j=Q(F(j,0),1);c["stroke-width"]==null&&(r=f["stroke-width"]);c["stroke-width"]&&(e.weight=r);r&&r<1&&(j*=r)&&(e.weight=1);e.opacity=j;c["stroke-linejoin"]&&(e.joinstyle=c["stroke-linejoin"]||"miter");e.miterlimit=c["stroke-miterlimit"]||
8;c["stroke-linecap"]&&(e.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]=="square"?"square":"round");if(c["stroke-dasharray"]){j={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};e.dashstyle=j[J](c["stroke-dasharray"])?j[c["stroke-dasharray"]]:""}n&&d.appendChild(e)}if(a.type=="text"){j=a.paper.span.style;f.font&&(j.font=f.font);f["font-family"]&&(j.fontFamily=
f["font-family"]);f["font-size"]&&(j.fontSize=f["font-size"]);f["font-weight"]&&(j.fontWeight=f["font-weight"]);f["font-style"]&&(j.fontStyle=f["font-style"]);a.node.string&&(a.paper.span.innerHTML=g(a.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));a.W=f.w=a.paper.span.offsetWidth;a.H=f.h=a.paper.span.offsetHeight;a.X=f.x;a.Y=f.y+da(a.H/2);switch(f["text-anchor"]){case "start":a.node.style["v-text-align"]="left";a.bbx=da(a.W/2);break;case "end":a.node.style["v-text-align"]=
"right";a.bbx=-da(a.W/2);break;default:a.node.style["v-text-align"]="center"}}};Ca=function(a,c){a.attrs=a.attrs||{};var d,f="linear",j=".5 .5";a.attrs.gradient=c;c=g(c).replace($a,function(I,M,N){f="radial";if(M&&N){M=aa(M);N=aa(N);q(M-0.5,2)+q(N-0.5,2)>0.25&&(N=B.sqrt(0.25-q(M-0.5,2))*((N>0.5)*2-1)+0.5);j=M+P+N}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var e=c.shift();e=-aa(e);if(isNaN(e))return null}var n=db(c);if(!n)return null;a=a.shape||a.node;d=a.getElementsByTagName("fill")[0]||ra("fill");
!d.parentNode&&a.appendChild(d);if(n[m]){d.on=true;d.method="none";d.color=n[0].color;d.color2=n[n[m]-1].color;for(var r=[],s=0,w=n[m];s<w;s++)n[s].offset&&r[ca](n[s].offset+P+n[s].color);d.colors&&(d.colors.value=r[m]?r[p]():"0% "+d.color);if(f=="radial"){d.type="gradientradial";d.focus="100%";d.focussize=j;d.focusposition=j}else{d.type="gradient";d.angle=(270-e)%360}}return 1};ka=function(a,c,d){this[0]=a;this.id=l._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=c;this.paper=
d;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=this);d.top=this;this.next=null};ja=ka[T];ja.rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][p](P);return this._.rt.deg}a=g(a).split(S);if(a[m]-1){c=aa(a[1]);d=aa(a[2])}a=aa(a[0]);c!=null?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;this.setBox(this.attrs,c,d);this.Group.style.rotation=
this._.rt.deg;return this};ja.setBox=function(a,c,d){if(this.removed)return this;var f=this.Group.style,j=this.shape&&this.shape.style||this.node.style;a=a||{};for(var e in a)a[J](e)&&(this.attrs[e]=a[e]);c=c||this._.rt.cx;d=d||this._.rt.cy;var n=this.attrs,r;switch(this.type){case "circle":a=n.cx-n.r;e=n.cy-n.r;r=n=n.r*2;break;case "ellipse":a=n.cx-n.rx;e=n.cy-n.ry;r=n.rx*2;n=n.ry*2;break;case "image":a=+n.x;e=+n.y;r=n.width||0;n=n.height||0;break;case "text":this.textpath.v=["m",da(n.x),", ",da(n.y-
2),"l",da(n.x)+1,", ",da(n.y-2)][p]("");a=n.x-da(this.W/2);e=n.y-this.H/2;r=this.W;n=this.H;break;case "rect":case "path":if(this.attrs.path){n=Ja(this.attrs.path);a=n.x;e=n.y;r=n.width;n=n.height}else{e=a=0;r=this.paper.width;n=this.paper.height}break;default:e=a=0;r=this.paper.width;n=this.paper.height}c=(c==null?a+r/2:c)-this.paper.width/2;d=(d==null?e+n/2:d)-this.paper.height/2;var s;f.left!=(s=c+"px")&&(f.left=s);f.top!=(s=d+"px")&&(f.top=s);this.X=Ea[J](this.type)?-c:a;this.Y=Ea[J](this.type)?
-d:e;this.W=r;this.H=n;if(Ea[J](this.type)){j.left!=(s=-c*10+"px")&&(j.left=s);j.top!=(s=-d*10+"px")&&(j.top=s)}else if(this.type=="text"){j.left!=(s=-c+"px")&&(j.left=s);j.top!=(s=-d+"px")&&(j.top=s)}else{f.width!=(s=this.paper.width+"px")&&(f.width=s);f.height!=(s=this.paper.height+"px")&&(f.height=s);j.left!=(s=a-c+"px")&&(j.left=s);j.top!=(s=e-d+"px")&&(j.top=s);j.width!=(s=r+"px")&&(j.width=s);j.height!=(s=n+"px")&&(j.height=s)}};ja.hide=function(){!this.removed&&(this.Group.style.display="none");
return this};ja.show=function(){!this.removed&&(this.Group.style.display="block");return this};ja.getBBox=function(){if(this.removed)return this;if(Ea[J](this.type))return Ja(this.attrs.path);return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};ja.remove=function(){if(!this.removed){Aa(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=
true}};ja.attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[J](f)&&(d[f]=this.attrs[f]);this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&l.is(a,"string")){if(a=="translation")return La.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;
return this.attrs[a]}if(this.attrs&&c==null&&l.is(a,O)){var j={};f=0;for(d=a[m];f<d;f++)j[a[f]]=this.attr(a[f]);return j}if(c!=null){d={};d[a]=c}c==null&&l.is(a,"object")&&(d=a);if(d){for(j in this.paper.customAttributes)if(this.paper.customAttributes[J](j)&&d[J](j)&&l.is(this.paper.customAttributes[j],"function")){f=this.paper.customAttributes[j].apply(this,[].concat(d[j]));this.attrs[j]=d[j];for(var e in f)f[J](e)&&(d[e]=f[e])}d.text&&this.type=="text"&&(this.node.string=d.text);ya(this,d);d.gradient&&
({circle:1,ellipse:1}[J](this.type)||g(d.gradient).charAt()!="r")&&Ca(this,d.gradient);(!Ea[J](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this};ja.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&fb(this,this.paper);return this};ja.toBack=function(){if(this.removed)return this;if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);gb(this,this.paper)}return this};
ja.insertAfter=function(a){if(this.removed)return this;a.constructor==ta&&(a=a[a.length-1]);a.Group.nextSibling?a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);hb(this,a,this.paper);return this};ja.insertBefore=function(a){if(this.removed)return this;a.constructor==ta&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);ib(this,a,this.paper);return this};ja.blur=function(a){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(Hb,"");
if(+a!==0){this.attrs.blur=a;c.filter=d+P+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")";c.margin=l.format("-{0}px 0 0 -{0}px",da(+a||1.5))}else{c.filter=d;c.margin=0;delete this.attrs.blur}};lb=function(a,c,d,f){var j=ra("group"),e=ra("oval");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=Da;j.coordorigin=a.coordorigin;j.appendChild(e);e=new ka(e,j,a);e.type="circle";ya(e,{stroke:"#000",fill:"none"});e.attrs.cx=c;e.attrs.cy=
d;e.attrs.r=f;e.setBox({x:c-f,y:d-f,width:f*2,height:f*2});a.canvas.appendChild(j);return e};var sb=function(a,c,d,f,j){return j?l.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+j,c,d-j*2,j,-j,f-j*2,j*2-d,j*2-f):l.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,d,f,-d)};mb=function(a,c,d,f,j,e){var n=sb(c,d,f,j,e);a=a.path(n);var r=a.attrs;a.X=r.x=c;a.Y=r.y=d;a.W=r.width=f;a.H=r.height=j;r.r=e;r.path=n;a.type="rect";return a};
nb=function(a,c,d,f,j){var e=ra("group"),n=ra("oval");e.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";e.coordsize=Da;e.coordorigin=a.coordorigin;e.appendChild(n);n=new ka(n,e,a);n.type="ellipse";ya(n,{stroke:"#000"});n.attrs.cx=c;n.attrs.cy=d;n.attrs.rx=f;n.attrs.ry=j;n.setBox({x:c-f,y:d-j,width:f*2,height:j*2});a.canvas.appendChild(e);return n};ob=function(a,c,d,f,j,e){var n=ra("group"),r=ra("image");n.style.cssText="position:absolute;left:0;top:0;width:"+
a.width+"px;height:"+a.height+"px";n.coordsize=Da;n.coordorigin=a.coordorigin;r.src=c;n.appendChild(r);r=new ka(r,n,a);r.type="image";r.attrs.src=c;r.attrs.x=d;r.attrs.y=f;r.attrs.w=j;r.attrs.h=e;r.setBox({x:d,y:f,width:j,height:e});a.canvas.appendChild(n);return r};pb=function(a,c,d,f){var j=ra("group"),e=ra("shape"),n=e.style,r=ra("path"),s=ra("textpath");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=Da;j.coordorigin=a.coordorigin;r.v=l.format("m{0},{1}l{2},{1}",
da(c*10),da(d*10),da(c*10)+1);r.textpathok=true;n.width=a.width;n.height=a.height;s.string=g(f);s.on=true;e.appendChild(s);e.appendChild(r);j.appendChild(e);n=new ka(s,j,a);n.shape=e;n.textpath=r;n.type="text";n.attrs.text=f;n.attrs.x=c;n.attrs.y=d;n.attrs.w=1;n.attrs.h=1;ya(n,{font:Fa.font,stroke:"none",fill:"#000"});n.setBox();a.canvas.appendChild(j);return n};qb=function(a,c){var d=this.canvas.style;a==+a&&(a+="px");c==+c&&(c+="px");d.width=a;d.height=c;d.clip="rect(0 "+a+" "+c+" 0)";return this};
var ra;k.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!k.namespaces.rvml&&k.namespaces.add("rvml","urn:schemas-microsoft-com:vml");ra=function(a){return k.createElement("<rvml:"+a+' class="rvml">')}}catch(Qb){ra=function(a){return k.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Oa=function(){var a=eb[v](0,arguments),c=a.container,d=a.height,f=a.width,j=a.x;a=a.y;if(!c)throw Error("VML container not found.");var e=new L,n=e.canvas=k.createElement("div"),
r=n.style;j=j||0;a=a||0;f=f||512;d=d||342;f==+f&&(f+="px");d==+d&&(d+="px");e.width=1E3;e.height=1E3;e.coordsize=1E4+P+1E4;e.coordorigin="0 0";e.span=k.createElement("span");e.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";n.appendChild(e.span);r.cssText=l.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d);if(c==1){k.body.appendChild(n);r.left=j+"px";r.top=a+
"px";r.position="absolute"}else c.firstChild?c.insertBefore(n,c.firstChild):c.appendChild(n);Sa.call(e,e,l.fn);return e};o.clear=function(){this.canvas.innerHTML="";this.span=k.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};o.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=jb(a);return true}}ua=navigator.userAgent.match(/Version\\x2f(.*?)\s/);
navigator.vendor=="Apple Computer, Inc."&&(ua&&ua[1]<4||navigator.platform.slice(0,2)=="iP")?o.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});D.setTimeout(function(){a.remove()})}:o.safari=function(){};var Kb=function(){this.returnValue=false},Lb=function(){return this.originalEvent.preventDefault()},Mb=function(){this.cancelBubble=true},Nb=function(){return this.originalEvent.stopPropagation()},Ob=function(){if(k.addEventListener)return function(a,c,
d,f){var j=E&&y[c]?y[c]:c,e=function(n){if(E&&y[J](c))for(var r=0,s=n.targetTouches&&n.targetTouches.length;r<s;r++)if(n.targetTouches[r].target==a){s=n;n=n.targetTouches[r];n.originalEvent=s;n.preventDefault=Lb;n.stopPropagation=Nb;break}return d.call(f,n)};a.addEventListener(j,e,false);return function(){a.removeEventListener(j,e,false);return true}};if(k.attachEvent)return function(a,c,d,f){var j=function(e){e=e||D.event;e.preventDefault=e.preventDefault||Kb;e.stopPropagation=e.stopPropagation||
Mb;return d.call(f,e)};a.attachEvent("on"+c,j);return function(){a.detachEvent("on"+c,j);return true}}}(),va=[],Ua=function(a){for(var c=a.clientX,d=a.clientY,f=k.documentElement.scrollTop||k.body.scrollTop,j=k.documentElement.scrollLeft||k.body.scrollLeft,e,n=va.length;n--;){e=va[n];if(E)for(var r=a.touches.length,s;r--;){s=a.touches[r];if(s.identifier==e.el._drag.id){c=s.clientX;d=s.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=j;d+=f;e.move&&e.move.call(e.move_scope||
e.el,c-e.el._drag.x,d-e.el._drag.y,c,d,a)}},Va=function(a){l.unmousemove(Ua).unmouseup(Va);for(var c=va.length,d;c--;){d=va[c];d.el._drag={};d.end&&d.end.call(d.end_scope||d.start_scope||d.move_scope||d.el,a)}va=[]};for(ua=h[m];ua--;)(function(a){l[a]=ka[T][a]=function(c,d){if(l.is(c,"function")){this.events=this.events||[];this.events.push({name:a,f:c,unbind:Ob(this.shape||this.node||k,a,c,d||this)})}return this};l["un"+a]=ka[T]["un"+a]=function(c){for(var d=this.events,f=d[m];f--;)if(d[f].name==
a&&d[f].f==c){d[f].unbind();d.splice(f,1);!d.length&&delete this.events;break}return this}})(h[ua]);ja.hover=function(a,c,d,f){return this.mouseover(a,d).mouseout(c,f||d)};ja.unhover=function(a,c){return this.unmouseover(a).unmouseout(c)};ja.drag=function(a,c,d,f,j,e){this._drag={};this.mousedown(function(n){(n.originalEvent||n).preventDefault();var r=k.documentElement.scrollTop||k.body.scrollTop,s=k.documentElement.scrollLeft||k.body.scrollLeft;this._drag.x=n.clientX+s;this._drag.y=n.clientY+r;this._drag.id=
n.identifier;c&&c.call(j||f||this,n.clientX+s,n.clientY+r,n);!va.length&&l.mousemove(Ua).mouseup(Va);va.push({el:this,move:a,end:d,move_scope:f,start_scope:j,end_scope:e})});return this};ja.undrag=function(a,c,d){for(c=va.length;c--;)va[c].el==this&&va[c].move==a&&va[c].end==d&&va.splice(c++,1);!va.length&&l.unmousemove(Ua).unmouseup(Va)};o.circle=function(a,c,d){return lb(this,a||0,c||0,d||0)};o.rect=function(a,c,d,f,j){return mb(this,a||0,c||0,d||0,f||0,j||0)};o.ellipse=function(a,c,d,f){return nb(this,
a||0,c||0,d||0,f||0)};o.path=function(a){a&&!l.is(a,"string")&&!l.is(a[0],O)&&(a+="");return kb(l.format[v](l,arguments),this)};o.image=function(a,c,d,f,j){return ob(this,a||"about:blank",c||0,d||0,f||0,j||0)};o.text=function(a,c,d){return pb(this,a||0,c||0,g(d))};o.set=function(a){arguments[m]>1&&(a=Array[T].splice.call(arguments,0,arguments[m]));return new ta(a)};o.setSize=qb;o.top=o.bottom=null;o.raphael=l;ja.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale=
"1 1"};ja.scale=function(a,c,d,f){if(this.removed)return this;if(a==null&&c==null)return{x:this._.sx,y:this._.sy,toString:C};c=c||a;!+c&&(c=a);var j,e,n=this.attrs;if(a!=0){var r=this.getBBox(),s=r.x+r.width/2,w=r.y+r.height/2;j=i(a/this._.sx);e=i(c/this._.sy);d=+d||d==0?d:s;f=+f||f==0?f:w;var I=this._.sx>0,M=this._.sy>0;r=~~(a/i(a));var N=~~(c/i(c)),X=j*r,fa=e*N,Y=this.node.style;s=d+i(s-d)*X*(s>d==I?1:-1);w=f+i(w-f)*fa*(w>f==M?1:-1);var V=a*r>c*N?e:j;switch(this.type){case "rect":case "image":var ba=
n.width*j,la=n.height*e;this.attr({height:la,r:n.r*V,width:ba,x:s-ba/2,y:w-la/2});break;case "circle":case "ellipse":this.attr({rx:n.rx*j,ry:n.ry*e,r:n.r*V,cx:s,cy:w});break;case "text":this.attr({x:s,y:w});break;case "path":V=Ra(n.path);var pa=true;I=I?X:j;M=M?fa:e;fa=0;for(X=V[m];fa<X;fa++){var qa=V[fa],na=xa.call(qa[0]);if(!(na=="M"&&pa)){pa=false;if(na=="A"){qa[V[fa][m]-2]*=I;qa[V[fa][m]-1]*=M;qa[1]*=j;qa[2]*=e;qa[5]=+(r+N?!!+qa[5]:!+qa[5])}else if(na=="H"){na=1;for(var za=qa[m];na<za;na++)qa[na]*=
I}else if(na=="V"){na=1;for(za=qa[m];na<za;na++)qa[na]*=M}else{na=1;for(za=qa[m];na<za;na++)qa[na]*=na%2?I:M}}}e=Ja(V);j=s-e.x-e.width/2;e=w-e.y-e.height/2;V[0][1]+=j;V[0][2]+=e;this.attr({path:V})}if(this.type in{text:1,image:1}&&(r!=1||N!=1))if(this.transformations){this.transformations[2]="scale(".concat(r,",",N,")");this.node.setAttribute("transform",this.transformations[p](P));j=r==-1?-n.x-(ba||0):n.x;e=N==-1?-n.y-(la||0):n.y;this.attr({x:j,y:e});n.fx=r-1;n.fy=N-1}else{this.node.filterMatrix=
" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(r,", M12=0, M21=0, M22=",N,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");Y.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}else if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[p](P));n.fx=0;n.fy=0}else{this.node.filterMatrix="";Y.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}n.scale=[a,c,d,f][p](P);this._.sx=a;this._.sy=
c}return this};ja.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};var Wa={},Ma=function(a,c,d,f,j,e,n,r,s){var w=0,I=100,M=[a,c,d,f,j,e,n,r].join(),N=Wa[M],X,fa;!N&&(Wa[M]=N={data:[]});N.timer&&clearTimeout(N.timer);N.timer=setTimeout(function(){delete Wa[M]},2E3);if(s!=null)I=~~Ma(a,c,d,f,j,e,n,r)*10;for(var Y=0;Y<I+1;Y++){if(N.data[s]>Y)fa=N.data[Y*I];else{fa=l.findDotsAtSegment(a,c,d,f,j,e,n,r,Y/I);N.data[Y]=
fa}Y&&(w+=q(q(X.x-fa.x,2)+q(X.y-fa.y,2),0.5));if(s!=null&&w>=s)return fa;X=fa}if(s==null)return w};h=function(a,c){return function(d,f,j){d=Ia(d);for(var e,n,r,s,w="",I={},M=0,N=0,X=d.length;N<X;N++){r=d[N];if(r[0]=="M"){e=+r[1];n=+r[2]}else{s=Ma(e,n,r[1],r[2],r[3],r[4],r[5],r[6]);if(M+s>f){if(c&&!I.start){e=Ma(e,n,r[1],r[2],r[3],r[4],r[5],r[6],f-M);w+=["C",e.start.x,e.start.y,e.m.x,e.m.y,e.x,e.y];if(j)return w;I.start=w;w=["M",e.x,e.y+"C",e.n.x,e.n.y,e.end.x,e.end.y,r[5],r[6]][p]();M+=s;e=+r[5];
n=+r[6];continue}if(!a&&!c){e=Ma(e,n,r[1],r[2],r[3],r[4],r[5],r[6],f-M);return{x:e.x,y:e.y,alpha:e.alpha}}}M+=s;e=+r[5];n=+r[6]}w+=r}I.end=w;e=a?M:c?I:l.findDotsAtSegment(e,n,r[1],r[2],r[3],r[4],r[5],r[6],1);e.alpha&&(e={x:e.x,y:e.y,alpha:e.alpha});return e}};var tb=h(1),Na=h(),Xa=h(0,1);ja.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return tb(this.attrs.path)}};ja.getPointAtLength=function(a){if(this.type=="path")return Na(this.attrs.path,
a)};ja.getSubpath=function(a,c){if(this.type=="path"){if(i(this.getTotalLength()-c)<"1e-6")return Xa(this.attrs.path,a).end;var d=Xa(this.attrs.path,c,1);return a?Xa(d,a).end:d}};l.easing_formulas={linear:function(a){return a},"<":function(a){return q(a,3)},">":function(a){return q(a-1,3)+1},"<>":function(a){a*=2;if(a<1)return q(a,3)/2;a-=2;return(q(a,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){if(a==0||
a==1)return a;return q(2,-10*a)*B.sin((a-0.075)*2*z/0.3)+1},bounce:function(a){if(a<1/2.75)a*=7.5625*a;else if(a<2/2.75){a-=1.5/2.75;a=7.5625*a*a+0.75}else if(a<2.5/2.75){a-=2.25/2.75;a=7.5625*a*a+0.9375}else{a-=2.625/2.75;a=7.5625*a*a+0.984375}return a}};var wa=[],ub=function(){for(var a=+new Date,c=0;c<wa[m];c++){var d=wa[c];if(!(d.stop||d.el.removed)){var f=a-d.start,j=d.ms,e=d.easing,n=d.from,r=d.diff,s=d.to,w=d.t,I=d.el;d={};var M;if(f<j){f=e(f/j);for(var N in n)if(n[J](N)){switch(Pa[N]){case "along":M=
f*j*r[N];s.back&&(M=s.len-M);e=Na(s[N],M);I.translate(r.sx-r.x||0,r.sy-r.y||0);r.x=e.x;r.y=e.y;I.translate(e.x-r.sx,e.y-r.sy);s.rot&&I.rotate(r.r+e.alpha,e.x,e.y);break;case G:M=+n[N]+f*j*r[N];break;case "colour":M="rgb("+[Ya(da(n[N].r+f*j*r[N].r)),Ya(da(n[N].g+f*j*r[N].g)),Ya(da(n[N].b+f*j*r[N].b))][p](",")+")";break;case "path":M=[];e=0;for(var X=n[N][m];e<X;e++){M[e]=[n[N][e][0]];for(var fa=1,Y=n[N][e][m];fa<Y;fa++)M[e][fa]=+n[N][e][fa]+f*j*r[N][e][fa];M[e]=M[e][p](P)}M=M[p](P);break;case "csv":switch(N){case "translation":M=
f*j*r[N][0]-w.x;e=f*j*r[N][1]-w.y;w.x+=M;w.y+=e;M=M+P+e;break;case "rotation":M=+n[N][0]+f*j*r[N][0];n[N][1]&&(M+=","+n[N][1]+","+n[N][2]);break;case "scale":M=[+n[N][0]+f*j*r[N][0],+n[N][1]+f*j*r[N][1],2 in s[N]?s[N][2]:"",3 in s[N]?s[N][3]:""][p](P);break;case "clip-rect":M=[];for(e=4;e--;)M[e]=+n[N][e]+f*j*r[N][e]}break;default:X=[].concat(n[N]);M=[];for(e=I.paper.customAttributes[N].length;e--;)M[e]=+X[e]+f*j*r[N][e]}d[N]=M}I.attr(d);I._run&&I._run.call(I)}else{if(s.along){e=Na(s.along,s.len*
!s.back);I.translate(r.sx-(r.x||0)+e.x-r.sx,r.sy-(r.y||0)+e.y-r.sy);s.rot&&I.rotate(r.r+e.alpha,e.x,e.y)}(w.x||w.y)&&I.translate(-w.x,-w.y);s.scale&&(s.scale+="");I.attr(s);wa.splice(c--,1)}}}l.svg&&I&&I.paper&&I.paper.safari();wa[m]&&setTimeout(ub)},Pb=function(a,c,d,f,j){var e=d-f;c.timeouts.push(setTimeout(function(){l.is(j,"function")&&j.call(c);c.animate(a,e,a.easing)},f))},Ya=function(a){return F(Q(a,255),0)},La=function(a,c){if(a==null)return{x:this._.tx,y:this._.ty,toString:C};this._.tx+=
+a;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+c+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+this.attrs.x,y:+c+this.attrs.y});break;case "path":var d=Ra(this.attrs.path);d[0][1]+=+a;d[0][2]+=+c;this.attr({path:d})}return this};ja.animateWith=function(a,c,d,f,j){for(var e=0,n=wa.length;e<n;e++)wa[e].el.id==a.id&&(c.start=wa[e].start);return this.animate(c,d,f,j)};ja.animateAlong=W();ja.animateAlongBack=W(1);ja.onAnimation=
function(a){this._run=a||0;return this};ja.animate=function(a,c,d,f){var j=this;j.timeouts=j.timeouts||[];if(l.is(d,"function")||!d)f=d||null;if(j.removed){f&&f.call(j);return j}var e={},n={},r=false,s={},w;for(w in a)if(a[J](w))if(Pa[J](w)||j.paper.customAttributes[J](w)){r=true;e[w]=j.attr(w);e[w]==null&&(e[w]=Fa[w]);n[w]=a[w];switch(Pa[w]){case "along":var I=tb(a[w]),M=Na(a[w],I*!!a.back),N=j.getBBox();s[w]=I/c;s.tx=N.x;s.ty=N.y;s.sx=M.x;s.sy=M.y;n.rot=a.rot;n.back=a.back;n.len=I;a.rot&&(s.r=aa(j.rotate())||
0);break;case G:s[w]=(n[w]-e[w])/c;break;case "colour":e[w]=l.getRGB(e[w]);I=l.getRGB(n[w]);s[w]={r:(I.r-e[w].r)/c,g:(I.g-e[w].g)/c,b:(I.b-e[w].b)/c};break;case "path":I=Ia(e[w],n[w]);e[w]=I[0];N=I[1];s[w]=[];I=0;for(M=e[w][m];I<M;I++){s[w][I]=[0];for(var X=1,fa=e[w][I][m];X<fa;X++)s[w][I][X]=(N[I][X]-e[w][I][X])/c}break;case "csv":M=g(a[w]).split(S);N=g(e[w]).split(S);switch(w){case "translation":e[w]=[0,0];s[w]=[M[0]/c,M[1]/c];break;case "rotation":e[w]=N[1]==M[1]&&N[2]==M[2]?N:[0,M[1],M[2]];s[w]=
[(M[0]-e[w][0])/c,0,0];break;case "scale":a[w]=M;e[w]=g(e[w]).split(S);s[w]=[(M[0]-e[w][0])/c,(M[1]-e[w][1])/c,0,0];break;case "clip-rect":e[w]=g(e[w]).split(S);s[w]=[];for(I=4;I--;)s[w][I]=(M[I]-e[w][I])/c}n[w]=M;break;default:M=[].concat(a[w]);N=[].concat(e[w]);s[w]=[];for(I=j.paper.customAttributes[w][m];I--;)s[w][I]=((M[I]||0)-(N[I]||0))/c}}if(r){w=l.easing_formulas[d];if(!w)if((w=g(d).match(sa))&&w[m]==5){var Y=w;w=function(la){return A(la,+Y[1],+Y[2],+Y[3],+Y[4],c)}}else w=function(la){return la};
wa.push({start:a.start||+new Date,ms:c,easing:w,from:e,diff:s,to:n,el:j,t:{x:0,y:0}});l.is(f,"function")&&(j._ac=setTimeout(function(){f.call(j)},c));wa[m]==1&&setTimeout(ub)}else{d=[];var V,ba;for(ba in a)if(a[J](ba)&&vb.test(ba)){w={value:a[ba]};ba=="from"&&(ba=0);ba=="to"&&(ba=100);w.key=oa(ba,10);d.push(w)}d.sort(Bb);d[0].key&&d.unshift({key:0,value:j.attrs});I=0;for(M=d[m];I<M;I++)Pb(d[I].value,j,c/100*d[I].key,c/100*(d[I-1]&&d[I-1].key||0),d[I-1]&&d[I-1].value.callback);(V=d[d[m]-1].value.callback)&&
j.timeouts.push(setTimeout(function(){V.call(j)},c))}return this};ja.stop=function(){for(var a=0;a<wa.length;a++)wa[a].el.id==this.id&&wa.splice(a--,1);a=0;for(ii=this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};ja.translate=function(a,c){return this.attr({translation:a+" "+c})};ja[Z]=function(){return"Rapha\u00ebl\u2019s object"};l.ae=wa;var ta=function(a){this.items=[];this[m]=0;this.type="set";if(a)for(var c=
0,d=a[m];c<d;c++)if(a[c]&&(a[c].constructor==ka||a[c].constructor==ta)){this[this.items[m]]=this.items[this.items[m]]=a[c];this[m]++}};ta[T][ca]=function(){for(var a,c,d=0,f=arguments[m];d<f;d++)if((a=arguments[d])&&(a.constructor==ka||a.constructor==ta)){c=this.items[m];this[c]=this.items[c]=a;this[m]++}return this};ta[T].pop=function(){delete this[this[m]--];return this.items.pop()};for(var Za in ja)ja[J](Za)&&(ta[T][Za]=function(a){return function(){for(var c=0,d=this.items[m];c<d;c++)this.items[c][a][v](this.items[c],
arguments);return this}}(Za));ta[T].attr=function(a,c){if(a&&l.is(a,O)&&l.is(a[0],"object"))for(var d=0,f=a[m];d<f;d++)this.items[d].attr(a[d]);else{d=0;for(f=this.items[m];d<f;d++)this.items[d].attr(a,c)}return this};ta[T].animate=function(a,c,d,f){(l.is(d,"function")||!d)&&(f=d||null);var j=this.items[m],e=j,n,r=this,s;f&&(s=function(){!--j&&f.call(r)});d=l.is(d,"string")?d:s;for(n=this.items[--e].animate(a,c,d,s);e--;)this.items[e]&&!this.items[e].removed&&this.items[e].animateWith(n,a,c,d,s);
return this};ta[T].insertAfter=function(a){for(var c=this.items[m];c--;)this.items[c].insertAfter(a);return this};ta[T].getBBox=function(){for(var a=[],c=[],d=[],f=[],j=this.items[m];j--;){var e=this.items[j].getBBox();a[ca](e.x);c[ca](e.y);d[ca](e.x+e.width);f[ca](e.y+e.height)}a=Q[v](0,a);c=Q[v](0,c);return{x:a,y:c,width:F[v](0,d)-a,height:F[v](0,f)-c}};ta[T].clone=function(a){a=new ta;for(var c=0,d=this.items[m];c<d;c++)a[ca](this.items[c].clone());return a};l.registerFont=function(a){if(!a.face)return a;
this.fonts=this.fonts||{};var c={w:a.w,face:{},glyphs:{}},d=a.face["font-family"],f;for(f in a.face)a.face[J](f)&&(c.face[f]=a.face[f]);this.fonts[d]?this.fonts[d][ca](c):this.fonts[d]=[c];if(!a.svg){c.face["units-per-em"]=oa(a.face["units-per-em"],10);for(var j in a.glyphs)if(a.glyphs[J](j)){d=a.glyphs[j];c.glyphs[j]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(n){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[n]||"M"})+"z"};if(d.k)for(var e in d.k)d[J](e)&&(c.glyphs[j].k[e]=d.k[e])}}return a};
o.getFont=function(a,c,d,f){f=f||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(l.fonts){var j=l.fonts[a];if(!j){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var e in l.fonts)if(l.fonts[J](e))if(a.test(e)){j=l.fonts[e];break}}var n;if(j){e=0;for(a=j[m];e<a;e++){n=j[e];if(n.face["font-weight"]==c&&(n.face["font-style"]==d||!n.face["font-style"])&&n.face["font-stretch"]==f)break}}return n}};o.print=function(a,c,d,f,j,e,n){e=e||"middle";
n=F(Q(n||0,1),-1);var r=this.set(),s=g(d).split(""),w=0;l.is(f,d)&&(f=this.getFont(f));if(f){d=(j||16)/f.face["units-per-em"];var I=f.face.bbox.split(S);j=+I[0];e=+I[1]+(e=="baseline"?I[3]-I[1]+ +f.face.descent:(I[3]-I[1])/2);I=0;for(var M=s[m];I<M;I++){var N=I&&f.glyphs[s[I-1]]||{},X=f.glyphs[s[I]];w+=I?(N.w||f.w)+(N.k&&N.k[s[I]]||0)+f.w*n:0;X&&X.d&&r[ca](this.path(X.d).attr({fill:"#000",stroke:"none",translation:[w,0]}))}r.scale(d,d,j,e).translate(a-j,c-e)}return r};l.format=function(a,c){var d=
l.is(c,O)?[0].concat(c):arguments;a&&l.is(a,"string")&&d[m]-1&&(a=a.replace(u,function(f,j){return d[++j]==null?"":d[j]}));return a||""};l.ninja=function(){H.was?D.Raphael=H.is:delete Raphael;return l};l.el=ja;l.st=ta[T];H.was?D.Raphael=l:Raphael=l})();(function(){function l(p){return(p+"").replace(E,"")}function U(p,m,x){for(var B=p.length;B<m;B++)p=x?"0"+p:p+"0";return p}function K(p){return y.call(p)==="[object Array]"}function C(p,m){if(p.indexOf)return p.indexOf(m);for(var x=0,B=p.length;x<B;x++)if(p[x]===m)return x;return-1}function W(p,m,x){var B=m["-"];m=m["+"];var F;switch(x){case "n -":B=" "+B;m=" "+m;case "n-":if(p.substr(p.length-B.length)===B)F=["-",p.substr(0,p.length-B.length)];else if(p.substr(p.length-m.length)===m)F=["+",p.substr(0,
p.length-m.length)];break;case "- n":B+=" ";m+=" ";case "-n":if(p.indexOf(B)===0)F=["-",p.substr(B.length)];else if(p.indexOf(m)===0)F=["+",p.substr(m.length)];break;case "(n)":if(p.indexOf("(")===0&&p.substr(p.length-1)===")")F=["-",p.substr(1,p.length-2)]}return F||["",p]}function A(p,m){if(!m)return 0;for(var x,B=p.getTime(),F=0,Q=m.length;F<Q;F++){x=m[F].start;if(x===null||B>=x)return F}return 0}function S(p){return p.split("\u00a0").join(" ").toUpperCase()}function R(p){for(var m=[],x=0,B=p.length;x<
B;x++)m[x]=S(p[x]);return m}function u(p,m,x,B){p=p.getFullYear();if(!B&&m.eras)p-=m.eras[x].offset;return p}function T(p,m){for(var x=0,B=false,F=0,Q=p.length;F<Q;F++){var i=p.charAt(F);switch(i){case "'":if(B)m.push("'");else x++;B=false;break;case "\\":B&&m.push("\\");B=!B;break;default:m.push(i);B=false}}return x}function J(p,m){m=m||"F";var x;x=p.patterns;var B=m.length;if(B===1){x=x[m];if(!x)throw"Invalid date format string '"+m+"'.";m=x}else if(B===2&&m.charAt(0)==="%")m=m.charAt(1);return m}
function k(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function D(p,m,x){p=l(p);x=x.calendar;a:{var B=x._parseRegExp;if(B){var F=B[m];if(F){m=F;break a}}else x._parseRegExp=B={};F=J(x,m).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var Q=["^"],i=[],q=0,z=0,G=k(),O;(O=G.exec(F))!==null;){var Z=F.slice(q,O.index);q=G.lastIndex;z+=T(Z,Q);if(z%2)Q.push(O[0]);else{Z=O[0];var ha=Z.length;switch(Z){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":Z=
"(\\D+)";break;case "tt":case "t":Z="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":Z="(\\d{"+ha+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":Z="(\\d\\d?)";break;case "zzz":Z="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":Z="([+-]?\\d\\d?)";break;case "/":Z="(\\"+x["/"]+")";break;default:throw"Invalid date format pattern '"+Z+"'.";}Z&&Q.push(Z);i.push(O[0])}}T(F.slice(q),Q);Q.push("$");F=
{regExp:Q.join("").replace(/\s+/g,"\\s+"),groups:i};m=B[m]=F}z=RegExp(m.regExp).exec(p);if(z===null)return null;G=m.groups;var ca=p=null,ga=null,ma=m=null;i=Q=F=B=0;O=null;q=false;Z=0;for(ha=G.length;Z<ha;Z++){var ia=z[Z+1];if(ia){var sa=G[Z],da=sa.length,aa=parseInt(ia,10);switch(sa){case "dd":case "d":m=aa;if(m<1||m>31)return null;break;case "MMM":case "MMMM":ga=x;da=da===3;sa=ga.months;var oa=ga.monthsGenitive||ga.months,xa=ga._upperMonths;aa=ga._upperMonthsGen;if(!xa){ga._upperMonths=xa=[R(sa.names),
R(sa.namesAbbr)];ga._upperMonthsGen=aa=[R(oa.names),R(oa.namesAbbr)]}ia=S(ia);ga=C(da?xa[1]:xa[0],ia);if(ga<0)ga=C(da?aa[1]:aa[0],ia);if(ga<0||ga>11)return null;break;case "M":case "MM":ga=aa-1;if(ga<0||ga>11)return null;break;case "y":case "yy":case "yyyy":if(da<4){ca=x;ia=aa;aa=new Date;sa=A(aa);if(ia<100){da=ca.twoDigitYearMax;da=typeof da==="string"?(new Date).getFullYear()%100+parseInt(da,10):da;ca=u(aa,ca,sa);ia+=ca-ca%100;if(ia>da)ia-=100}ca=ia}else ca=aa;if(ca<0||ca>9999)return null;break;
case "h":case "hh":B=aa;if(B===12)B=0;if(B<0||B>11)return null;break;case "H":case "HH":B=aa;if(B<0||B>23)return null;break;case "m":case "mm":F=aa;if(F<0||F>59)return null;break;case "s":case "ss":Q=aa;if(Q<0||Q>59)return null;break;case "tt":case "t":q=x.PM&&(ia===x.PM[0]||ia===x.PM[1]||ia===x.PM[2]);if(!q&&(!x.AM||ia!==x.AM[0]&&ia!==x.AM[1]&&ia!==x.AM[2]))return null;break;case "f":case "ff":case "fff":i=aa*Math.pow(10,3-da);if(i<0||i>999)return null;break;case "ddd":case "dddd":ma=ia;ia=da===
3;aa=void 0;aa=x.days;da=x._upperDays;if(!da)x._upperDays=da=[R(aa.names),R(aa.namesAbbr),R(aa.namesShort)];ma=S(ma);if(ia){aa=C(da[1],ma);if(aa===-1)aa=C(da[2],ma)}else aa=C(da[0],ma);ma=aa;if(ma<0||ma>6)return null;break;case "zzz":da=ia.split(/:/);if(da.length!==2)return null;O=parseInt(da[0],10);if(O<-12||O>13)return null;da=parseInt(da[1],10);if(da<0||da>59)return null;O=O*60+(ia.indexOf("-")===0?-da:da);break;case "z":case "zz":O=aa;if(O<-12||O>13)return null;O*=60;break;case "g":case "gg":if(!ia||
!x.eras)return null;ia=l(ia.toLowerCase());da=0;for(aa=x.eras.length;da<aa;da++)if(ia===x.eras[da].name.toLowerCase()){p=da;break}if(p===null)return null}}}z=new Date;G=(Z=x.convert)?Z.fromGregorian(z)[0]:z.getFullYear();if(ca===null)ca=G;else if(x.eras)ca+=x.eras[p||0].offset;if(ga===null)ga=0;if(m===null)m=1;if(Z){z=Z.toGregorian(ca,ga,m);if(z===null)return null}else{z.setFullYear(ca,ga,m);if(z.getDate()!==m)return null;if(ma!==null&&z.getDay()!==ma)return null}if(q&&B<12)B+=12;z.setHours(B,F,Q,
i);if(O!==null){x=z.getMinutes()-(O+z.getTimezoneOffset());z.setHours(z.getHours()+parseInt(x/60,10),x%60)}return z}function H(p,m,x){function B(da,aa){var oa;oa=da+"";if(aa>1&&oa.length<aa){oa=Z[aa-2]+oa;return oa.substr(oa.length-aa,aa)}return oa}function F(){if(ha||ca)return ha;ha=ga.test(m);ca=true;return ha}function Q(da,aa){if(sa)return sa[aa];switch(aa){case 0:return da.getFullYear();case 1:return da.getMonth();case 2:return da.getDate()}}var i=x.calendar,q=i.convert;if(!m||!m.length||m===
"i"){if(x&&x.name.length)if(q)x=H(p,i.patterns.F,x);else{x=new Date(p.getTime());var z=A(p,i.eras);x.setFullYear(u(p,i,z));x=x.toLocaleString()}else x=p.toString();return x}z=i.eras;var G=m==="s";m=J(i,m);x=[];var O,Z=["0","00","000"],ha,ca,ga=/([^d]|^)(d|dd)([^d]|$)/g,ma=0,ia=k(),sa;if(!G&&q)sa=q.fromGregorian(p);for(;;){O=ia.lastIndex;q=ia.exec(m);O=m.slice(O,q?q.index:m.length);ma+=T(O,x);if(!q)break;if(ma%2)x.push(q[0]);else{O=q[0];q=O.length;switch(O){case "ddd":case "dddd":x.push((q===3?i.days.namesAbbr:
i.days.names)[p.getDay()]);break;case "d":case "dd":ha=true;x.push(B(Q(p,2),q));break;case "MMM":case "MMMM":O=Q(p,1);x.push(i.monthsGenitive&&F()?i.monthsGenitive[q===3?"namesAbbr":"names"][O]:i.months[q===3?"namesAbbr":"names"][O]);break;case "M":case "MM":x.push(B(Q(p,1)+1,q));break;case "y":case "yy":case "yyyy":O=sa?sa[0]:u(p,i,A(p,z),G);if(q<4)O%=100;x.push(B(O,q));break;case "h":case "hh":O=p.getHours()%12;if(O===0)O=12;x.push(B(O,q));break;case "H":case "HH":x.push(B(p.getHours(),q));break;
case "m":case "mm":x.push(B(p.getMinutes(),q));break;case "s":case "ss":x.push(B(p.getSeconds(),q));break;case "t":case "tt":O=p.getHours()<12?i.AM?i.AM[0]:" ":i.PM?i.PM[0]:" ";x.push(q===1?O.charAt(0):O);break;case "f":case "ff":case "fff":x.push(B(p.getMilliseconds(),3).substr(0,q));break;case "z":case "zz":O=p.getTimezoneOffset()/60;x.push((O<=0?"+":"-")+B(Math.floor(Math.abs(O)),q));break;case "zzz":O=p.getTimezoneOffset()/60;x.push((O<=0?"+":"-")+B(Math.floor(Math.abs(O)),2)+":"+B(Math.abs(p.getTimezoneOffset()%
60),2));break;case "g":case "gg":i.eras&&x.push(i.eras[A(p,z)].name);break;case "/":x.push(i["/"]);break;default:throw"Invalid date format pattern '"+O+"'.";}}}return x.join("")}var L={},o={en:{}};o["default"]=o.en;L.extend=function(p){for(var m=arguments[1]||{},x=2,B=arguments.length;x<B;x++){var F=arguments[x];if(F)for(var Q in F){var i=F[Q];if(typeof i!=="undefined")if(p&&(y.call(i)==="[object Object]"||K(i))){var q=m[Q];q=q&&(y.call(q)==="[object Object]"||K(q))?q:K(i)?[]:{};m[Q]=this.extend(true,
q,i)}else m[Q]=i}}return m};L.findClosestCulture=function(p){var m;if(!p)return this.culture||this.cultures["default"];if(y.call(p)==="[object String]")p=p.split(",");if(K(p)){var x,B=this.cultures,F=p,Q,i=F.length,q=[];for(Q=0;Q<i;Q++){p=l(F[Q]);p=p.split(";");x=l(p[0]);if(p.length===1)p=1;else{p=l(p[1]);if(p.indexOf("q=")===0){p=p.substr(2);p=parseFloat(p,10);p=isNaN(p)?0:p}else p=1}q.push({lang:x,pri:p})}q.sort(function(G,O){return G.pri<O.pri?1:-1});for(Q=0;Q<i;Q++){x=q[Q].lang;if(m=B[x])return m}for(Q=
0;Q<i;Q++){x=q[Q].lang;do{F=x.lastIndexOf("-");if(F===-1)break;x=x.substr(0,F);if(m=B[x])return m}while(1)}for(Q=0;Q<i;Q++){x=q[Q].lang;for(var z in B){F=B[z];if(F.language==x)return F}}}else if(typeof p==="object")return p;return m||null};L.preferCulture=function(p){this.culture=this.findClosestCulture(p)||this.cultures["default"]};L.localize=function(p,m,x){if(typeof m!=="string")m=this.culture.name||this.culture||"default";m=this.cultures[m]||{name:m};var B=o[m.name];if(arguments.length===3){B||
(B=o[m.name]={});B[p]=x}else{if(B)x=B[p];if(typeof x==="undefined"){if(B=o[m.language])x=B[p];if(typeof x==="undefined")x=o["default"][p]}}return typeof x==="undefined"?null:x};L.format=function(p,m,x){x=this.findClosestCulture(x);if(typeof p==="number"){var B=p;if(!m||m==="i")p=x.name.length?B.toLocaleString():B.toString();else{m=m||"D";x=x.numberFormat;p=Math.abs(B);var F=-1;if(m.length>1)F=parseInt(m.slice(1),10);var Q=m.charAt(0).toUpperCase(),i;switch(Q){case "D":m="n";if(F!==-1)p=U(""+p,F,true);
if(B<0)p=-p;break;case "N":i=x;case "C":i=i||x.currency;case "P":i=i||x.percent;m=B<0?i.pattern[0]:i.pattern[1]||"n";if(F===-1)F=i.decimals;b:{var q=p*(Q==="P"?100:1);Q=i;i=Q.groupSizes;p=i[0];B=1;var z=Math.pow(10,F),G=Math.round(q*z)/z;isFinite(G)||(G=q);z="";z=(G+"").split(/e/i);G=z.length>1?parseInt(z[1],10):0;q=z[0];z=q.split(".");q=z[0];z=z.length>1?z[1]:"";if(G>0){z=U(z,G,false);q+=z.slice(0,G);z=z.substr(G)}else if(G<0){G=-G;q=U(q,G+1);z=q.slice(-G,q.length)+z;q=q.slice(0,-G)}z=F>0?Q["."]+
(z.length>F?z.slice(0,F):U(z,F)):"";F=q.length-1;Q=Q[","];for(G="";F>=0;){if(p===0||p>F){p=q.slice(0,F+1)+(G.length?Q+G+z:z);break b}G=q.slice(F-p+1,F+1)+(G.length?Q+G:"");F-=p;if(B<i.length){p=i[B];B++}}p=q.slice(0,F+1)+Q+G+z}break;default:throw"Bad number format specifier: "+Q;}i=/n|\$|-|%/g;for(B="";;){F=i.lastIndex;Q=i.exec(m);B+=m.slice(F,Q?Q.index:m.length);if(!Q)break;switch(Q[0]){case "n":B+=p;break;case "$":B+=x.currency.symbol;break;case "-":if(/[1-9]/.test(p))B+=x["-"];break;case "%":B+=
x.percent.symbol}}p=B}}else if(p instanceof Date)p=H(p,m,x);return p};L.parseInt=function(p,m,x){return Math.floor(this.parseFloat(p,m,x))};L.parseFloat=function(p,m,x){if(typeof m==="string"){x=m;m=10}x=this.findClosestCulture(x);var B=NaN,F=x.numberFormat;if(p.indexOf(x.numberFormat.currency.symbol)>-1){p=p.replace(x.numberFormat.currency.symbol,"");p=p.replace(x.numberFormat.currency["."],x.numberFormat["."])}p=l(p);if(P.test(p))B=parseFloat(p,m);else if(!m&&g.test(p))B=parseInt(p,16);else{x=W(p,
F,F.pattern[0]);m=x[0];x=x[1];if(m===""&&F.pattern[0]!=="-n"){x=W(p,F,"-n");m=x[0];x=x[1]}m=m||"+";var Q;p=x.indexOf("e");if(p<0)p=x.indexOf("E");if(p<0){Q=x;p=null}else{Q=x.substr(0,p);p=x.substr(p+1)}var i=F["."],q=Q.indexOf(i);if(q<0){x=Q;Q=null}else{x=Q.substr(0,q);Q=Q.substr(q+i.length)}i=F[","];x=x.split(i).join("");q=i.replace(/\u00A0/g," ");if(i!==q)x=x.split(q).join("");m+=x;if(Q!==null)m+="."+Q;if(p!==null){F=W(p,F,"-n");m+="e"+(F[0]||"+")+F[1]}if(h.test(m))B=parseFloat(m)}return B};L.parseDate=
function(p,m,x){x=this.findClosestCulture(x);var B,F;if(m){if(typeof m==="string")m=[m];if(m.length){F=0;for(var Q=m.length;F<Q;F++){var i=m[F];if(i)if(B=D(p,i,x))break}}}else{m=x.calendar.patterns;for(F in m)if(B=D(p,m[F],x))break}return B||null};var v=L.cultures=L.cultures||{};v=v["default"]=v.en=L.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %",
"n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September",
"October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},v.en);v.calendar=v.calendar||v.calendars.standard;var E=/^\s+|\s+$/g,P=
/^[+-]?infinity$/i,g=/^0x[a-f0-9]+$/i,h=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,y=Object.prototype.toString;jQuery.global=L})();timeglider=window.timeglider||{version:"0.1.0"};timeglider.TG_Date={};
(function(l){function U(k){return parseInt(k,10)}function K(k){var D=parseInt(k,10);return D>9||D<0?String(k):"0"+D}l=timeglider;var C=jQuery,W={},A={},S={},R={},u={},T=/^(\-?\d+)?(\-\d{1,2})?(\-\d{1,2})?(?:T| )?(\d{1,2})?(?::)?(\d{1,2})?(?::)?(\d{1,2})?(\+|\-)?(\d{1,2})?(?::)?(\d{1,2})?/;l.TG_Date=function(k,D,H){var L,o,v;H=H||0;if(typeof k=="number"){L=o=J.getDateFromSec(k);v=k+H}else if(typeof k!=="object"){if(k=="today")k=J.getToday();L=o=k}if(T.test(L)){k=J.parse8601(L);if(k.tz_ho)k=J.toFromUTC(k,
{hours:k.tz_ho,minutes:k.tz_mi},"to");C.extend(this,k);this.rd=J.getRataDie(this);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*12+(12-(this.mo-1)));if(!v){v=Math.abs(this.rd)*86400;k=this.ho*3600;L=(this.mi-1)*60;H=1;if(this.rd<0)H=-1;v=H*(v+k+L)}this.sec=v;this.date_display=D?D.toLowerCase().substr(0,2):"da";this.dateStr=o}else return{error:"invalid date"};return this};var J=l.TG_Date;J.getTimeUnitSerial=function(k,D){var H=0;switch(D){case "da":H=k.rd;break;case "mo":H=
k.mo_num;break;case "ye":H=k.ye;break;case "de":H=Math.floor(k.ye/10);break;case "ce":H=Math.floor(k.ye/100);break;case "thou":H=Math.floor(k.ye/1E3);break;case "tenthou":H=Math.floor(k.ye/1E4);break;case "hundredthou":H=Math.floor(k.ye/1E5);break;case "mill":H=Math.floor(k.ye/1E6);break;case "tenmill":H=Math.floor(k.ye/1E7);break;case "hundredmill":H=Math.floor(k.ye/1E8);break;case "bill":H=Math.floor(k.ye/1E9)}return H};J.getMonthDays=function(k,D){return J.isLeapYear(D)==true&&k==2?29:J.monthsDayNums[k]};
J.twentyFourToTwelve=function(k){var D={};D.ye=k.ye;D.mo=k.mo;D.da=k.da;D.ho=k.ho;D.mi=k.mi;D.ampm="am";if(k.ho)if(k.ho>=12){D.ampm="pm";D.ho=k.ho>12?k.ho-12:12}else if(k.ho==0){D.ho=12;D.ampm="am"}else D.ho=k.ho;else{D.ho=12;D.mi=0;D.ampm="am"}return D};J.getMonthAdj=function(k,D){var H=J.getDateFromMonthNum(k);switch(H.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:H=Math.floor(D+D/28*3);return{width:H,days:31};case 2:if(J.isLeapYear(H.ye)==true){H=Math.floor(D+D/28);return{width:H,days:29}}else return{width:D,
days:28};default:H=Math.floor(D+D/28*2);return{width:H,days:30}}};J.getDateFromMonthNum=function(k){var D=0;if(k>0){D=k%12;if(D==0)D=12;k=Math.ceil(k/12)}else{D=Math.abs(k)%12;D=12-D+1;if(D==13)D=1;k=-1*Math.ceil(Math.abs(k)/12)}return{ye:k,mo:D}};J.getMonthWidth=function(k,D,H){D=t/28;var L;switch(k){case 1:case 3:case 5:case 7:case 8:case 10:case 12:L=3;break;case 4:case 6:case 9:case 11:L=2;break;case 2:L=J.isLeapYear(yr)==true?1:0}return{width:Math.floor(H+D*L),numDays:28+L}};J.getToday=function(){var k=
new Date;return k.getFullYear()+"-"+(k.getMonth()+1)+"-"+k.getDate()+" "+k.getHours()+":"+k.getMinutes()+":00"};J.getMonthFromRemDays=function(k,D){var H=0;var L=H=0;H=J.isLeapYear(D)?1:0;if(k<=31){L=1;H=k}else if(k>31&&k<=59+H){L=2;H=k-(31+H)}else if(k>59+H&&k<=90+H){L=3;H=k-(59+H)}else if(k>90+H&&k<=120+H){L=4;H=k-(90+H)}else if(k>120+H&&k<=151+H){L=5;H=k-(120+H)}else if(k>151+H&&k<=181+H){L=6;H=k-(151+H)}else if(k>181+H&&k<=212+H){L=7;H=k-(181+H)}else if(k>212+H&&k<=243+H){L=8;H=k-(212+H)}else if(k>
243+H&&k<=273+H){L=9;H=k-(243+H)}else if(k>273+H&&k<=304+H){L=10;H=k-(273+H)}else if(k>304+H&&k<=334+H){L=11;H=k-(304+H)}else{L=12;H=k-(334+H)}return{mo:L,da:H}};J.getDateFromRD=function(k){if(R[k])return R[k];for(var D=Math.floor(k),H=Math.floor(D/146097)*400,L=D-Math.floor(D/146097)*146097,o=1,v=H+1,E=v+400;v<=E;v++)if(L>365){L-=365;if(J.isLeapYear(v))L-=1;o++}else v=E;H+=o;if(L==0)L=1;L=J.getMonthFromRemDays(L,H);o=(k-D)*1440;D=Math.floor(o%60);o=Math.floor(o/60);if(J.isLeapYear(H)&&L.mo==2)L.da+=
1;D=H+"-"+L.mo+"-"+L.da+" "+o+":"+D+":00";return R[k]=D};J.getDateFromSec=function(k){if(u[k])return u[k];var D=J.getDateFromRD(k/86400);return u[k]=D};J.isLeapYear=function(k){return k%400==0?true:k%100==0?false:k%4==0?true:false};J.getRataDie=function(k){function D(g,h){if(A[g+"-"+h])return A[g+"-"+h];for(var y=0,p=g;p<h;p++)y+=J.isLeapYear(p)?366:365;return A[g+"-"+h]=y}function H(g,h){var y;switch(g){case 1:y=0;break;case 2:y=31;break;case 3:y=59;break;case 4:y=90;break;case 5:y=120;break;case 6:y=
151;break;case 7:y=181;break;case 8:y=212;break;case 9:y=243;break;case 10:y=273;break;case 11:y=304;break;case 12:y=334}if(g>2)if(J.isLeapYear(h))y+=1;return y}var L=k.ye,o=k.mo;k=k.da;var v=0;if(W[L+"-"+o+"-"+k])return W[L+"-"+o+"-"+k];if(L>=0){if(L==0)L=1;v=Math.floor(L/400)*146097;var E=parseInt(D(L-L%400,L)),P=parseInt(H(o,L));v=v+E+P+k-366}else if(L<0)v=J.getBCRataDie({ye:L,mo:o,da:k});return W[L+"-"+o+"-"+k]=v};J.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];J.monthsDayNums=
[0,31,28,31,30,31,30,31,31,30,31,30,31,29];J.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];J.getBCRataDie=function(k){var D=k.ye,H=k.mo;k=k.da;if(S[D+"-"+H+"-"+k])return S[D+"-"+H+"-"+k];if(H==0)H=1;if(k==0)k=1;var L=-1*((Math.abs(D)-1)*366+[0,335,306,275,245,214,184,153,122,92,61,31,0][H]+(J.monthsDayNums[H]-k+1));return S[D+"-"+H+"-"+k]=L};J.setCulture=function(k){jQuery.global.culture=jQuery.global.cultures[k];J.monthNames=C.merge([""],jQuery.global.culture.calendar.months.names);
J.monthNamesAbbr=C.merge([""],jQuery.global.culture.calendar.months.namesAbbr);J.dayNames=jQuery.global.culture.calendar.days.names;J.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;J.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;J.patterns=jQuery.global.culture.calendar.patterns};J.prototype={format:function(k,D,H){H=H||{hours:0,minutes:0};if(D==true)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":k="yyyy";break;case "mo":k="MMM yyyy";break;case "da":k=
"MMM d, yyyy";break;case "ho":k="MMM d, yyyy h:mm tt";break;default:k="f"}if(this.ye>-27E4){D=J.toFromUTC(_.clone(this),H,"from");D=new Date(D.ye,D.mo-1,D.da,D.ho,D.mi,D.se,0);return C.global.format(D,k)}else return this.ye}};J.getTimeOffset=function(k){k=k.replace(/[^-\d:]/gi,"");var D=k.split(":"),H=parseInt(D[0],10);D=parseInt(D[1],10);var L=H+(H<0?-1:1)*(D/60);return{decimal:L,hours:H,minutes:D,seconds:L*3600,string:k}};J.tzOffsetStr=function(k,D){if(k){if(k.length==19)k+=D;else if(k.length==
16)k+=":00"+D;return k}};J.parse8601=function(k){var D,H,L,o,v;v=function(P){return P?parseInt(P.replace("-",""),10):0};var E=k.match(T);k=parseInt(E[1]);if(!k)return{error:"invalid date; no year provided"};D=v(E[2])||1;H=v(E[3])||1;L=v(E[4])||1;o=v(E[5])||0;v=v(E[6])||0;tz_pm=E[7]||"+";tz_ho=parseInt(E[8],10)||0;if(tz_pm=="-")tz_ho*=-1;tz_mi=parseInt(E[9],10)||0;if(tz_pm=="-")tz_mi*=-1;return{ye:k,mo:D,da:H,ho:L,mi:o,se:v,tz_ho:tz_ho,tz_mi:tz_mi}};J.getLastDayOfMonth=function(k,D){var H=[0,31,28,
31,30,31,30,31,31,30,31,30,31],L=0;return L=D==2&&J.isLeapYear(k)==true?29:H[D]};J.getDateTimeStrings=function(k){var D=J.parse8601(k);k=D.ye+"-"+K(D.mo)+"-"+K(D.da);var H="pm";if(D.ho>12){D.ho-=12;H="pm"}else{if(D.ho==0)D.ho="12";H="am"}D=U(D.ho)+":"+K(D.mi)+" "+H;return{date:k,time:D}};J.transValidateDateString=function(k){if(!k)return false;var D=k.match(/^(\-?\d+|today|now) ?(bce?)?-?(\d{1,2})?-?(\d{1,2})?/);zb=J.zeroButt;if(D){k=D[1];var H=D[2]||"",L=D[3]||"07";D=D[4]||"1";debug.log("bc:",H);
if(parseInt(k,10)<0||H.substr(0,1)=="b")k=-1*Math.abs(k);return J.validateDate(k,L,D)?k+"-"+zb(L)+"-"+zb(D):false}else return false};J.transValidateTimeString=function(k){if(!k)return"12:00:00";k=k.toLowerCase().match(/^(\d{1,2}|noon):?(\d{1,2})?:?(\d{1,2})? ?(am|pm)?/i);var D="";D=J.zeroButt;if(k[1])if(k[0]=="noon")D="12:00:00";else{var H=parseInt(k[1],10)||12,L=parseInt(k[2],10)||0,o=parseInt(k[3],10)||0;k=k[4]||"am";if(J.validateTime(H,L,o)==false)return false;if(k=="pm"&&H<12)H+=12;D=D(H)+":"+
D(L)+":"+D(o)}else D=false;return D};J.validateTime=function(k,D,H){if(k<0||k>23||D<0||D>59||H<0||H>59)return false;return true};J.validateDate=function(k,D,H){var L=J.getMonthDays(D,k);if(H>L||H<=0)return false;if(D>12||D<0)return false;if(k==0)return false;return true};J.zeroButt=function(k){k=parseInt(k,10);return k>9?String(k):"0"+k};J.toFromUTC=function(k,D,H){var L=0,o=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];L={};if(H=="from"){L.ho=-1*D.hours;L.mi=-1*D.minutes}else if(H=="to"){L.ho=D.hours;
L.mi=D.minutes}else{L.ho=-1*k.tz_ho;L.mi=-1*k.tz_mi}if(L.ho==0&&L.mi==0)return k;H=k.ho+k.mi/60+(-1*L.ho+L.mi*-1/60);if(H<0){L=24+H;if(k.da>1)k.da-=1;else if(k.mo==1){k.ye-=1;k.mo=12;k.da=31}else{k.mo-=1;k.da=J.getLastDayOfMonth(k.ye,k.mo)}}else if(H>=24){L=H-24;if(J.isLeapYear(k.ye)&&k.mo==2&&k.da==28)k.da=29;else if(k.da==o[k.mo]){if(k.mo==12){k.ye+=1;k.mo=1}else k.mo+=1;k.da=1}else k.da+=1}else L=H;o=function(v){v=Math.abs(v);var E=Math.floor(v);return{ho:E,mi:Math.round((v-E)*60),se:0}}(L);k.ho=
o.ho;k.mi=o.mi;if(D){k.tz_ho=D.tz_ho;k.tz_mi=D.tz_mi}else{k.tz_ho=0;k.tz_mi=0}return{ye:k.ye,mo:k.mo,da:k.da,ho:k.ho,mi:k.mi,se:k.se}};J.timezones=[{offset:"-12:00",name:"Int'l Date Line West"},{offset:"-11:00",name:"Bering & Nome"},{offset:"-10:00",name:"Alaska-Hawaii Standard Time"},{offset:"-10:00",name:"U.S. Hawaiian Standard Time"},{offset:"-10:00",name:"U.S. Central Alaska Time"},{offset:"-09:00",name:"U.S. Yukon Standard Time"},{offset:"-08:00",name:"U.S. Pacific Standard Time"},{offset:"-07:00",
name:"U.S. Mountain Standard Time"},{offset:"-07:00",name:"U.S. Pacific Daylight Time"},{offset:"-06:00",name:"U.S. Central Standard Time"},{offset:"-06:00",name:"U.S. Mountain Daylight Time"},{offset:"-05:00",name:"U.S. Eastern Standard Time"},{offset:"-05:00",name:"U.S. Central Daylight Time"},{offset:"-04:00",name:"U.S. Atlantic Standard Time"},{offset:"-04:00",name:"U.S. Eastern Daylight Time"},{offset:"-03:30",name:"Newfoundland Standard Time"},{offset:"-03:00",name:"Brazil Standard Time"},{offset:"-03:00",
name:"Atlantic Daylight Time"},{offset:"-03:00",name:"Greenland Standard Time"},{offset:"-02:00",name:"Azores Time"},{offset:"-01:00",name:"West Africa Time"},{offset:"00:00",name:"Greenwich Mean Time/UTC"},{offset:"00:00",name:"Western European Time"},{offset:"01:00",name:"Central European Time"},{offset:"01:00",name:"Middle European Time"},{offset:"01:00",name:"British Summer Time"},{offset:"01:00",name:"Middle European Winter Time"},{offset:"01:00",name:"Swedish Winter Time"},{offset:"01:00",name:"French Winter Time"},
{offset:"02:00",name:"Eastean EU"},{offset:"02:00",name:"USSR-zone1"},{offset:"02:00",name:"Middle European Summer Time"},{offset:"02:00",name:"French Summer Time"},{offset:"03:00",name:"Baghdad Time"},{offset:"03:00",name:"USSR-zone2"},{offset:"03:30",name:"Iran"},{offset:"04:00",name:"USSR-zone3"},{offset:"05:00",name:"USSR-zone4"},{offset:"05:30",name:"Indian Standard Time"},{offset:"06:00",name:"USSR-zone5"},{offset:"06:30",name:"North Sumatra Time"},{offset:"07:00",name:"USSR-zone6"},{offset:"07:00",
name:"West Australian Standard Time"},{offset:"07:30",name:"Java"},{offset:"08:00",name:"China & Hong Kong"},{offset:"08:00",name:"USSR-zone7"},{offset:"08:00",name:"West Australian Daylight Time"},{offset:"09:00",name:"Japan"},{offset:"09:00",name:"Korea"},{offset:"09:00",name:"USSR-zone8"},{offset:"09:30",name:"South Australian Standard Time"},{offset:"09:30",name:"Central Australian Standard Time"},{offset:"10:00",name:"Guam Standard Time"},{offset:"10:00",name:"USSR-zone9"},{offset:"10:00",name:"East Australian Standard Time"},
{offset:"10:30",name:"Central Australian Daylight Time"},{offset:"10:30",name:"South Australian Daylight Time"},{offset:"11:00",name:"USSR-zone10"},{offset:"11:00",name:"East Australian Daylight Time"},{offset:"12:00",name:"New Zealand Standard Time"},{offset:"12:00",name:"Int'l Date Line East"},{offset:"13:00",name:"New Zealand Daylight Time"}];J.boil=U;J.unboil=K})(timeglider);(function(l){var U=l.levelHeight=10;l.TG_Org=function(){var K=this,C=l.icon_folder;this.blocks=[];this.ids=[];this.vis=[];this.tree=[];this.pol=-1;this.addBlock=function(R,u){R.right=R.left+R.width;R.bottom=R.top+R.height;R.tickScope=u;K.blocks.push(R)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(R,u){if(R=="sweep"){W();this.vis=[]}this.blocks.sort(A);var T,J,k="",D="";html="";south_padding=0;b={};blength=this.blocks.length;b_span_color=
"";highest=title_adj=0;guageHighest=function(L){highest=L>highest?L:highest};for(var H=0;H<blength;H++){b=this.blocks[H];if(b.tickScope==R)if(_.indexOf(b.id,this.vis)==-1){this.vis.push(b.id);title_adj=0;if(b.html&&b.html.substr(0,4)=="<div")html+="<div style='left:"+b.left+"px' id='"+b.id+"'"+b.html.substr(4);else{if(b.image){if(b.image.display_class=="layout")title_adj=b.image.height+4;k="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"}else k="";
if(b.y_position>0)b.top=K.pol*b.y_position;else S(b,0);guageHighest(Math.abs(b.top));b_span_color=b.span_color?";background-color:"+b.span_color:"";b.fontsize<10?b.opacity=b.fontsize/10:b.opacity=1;if(b.span==true){T="timeglider-event-spanning";J="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px"+b_span_color+"'></div>"}else J=T="";D=b.icon?"<img class='timeglider-event-icon' src='"+C+b.icon+"' style='height:"+b.fontsize+"px;left:-"+
(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";if(u&&K.pol==-1&&Math.abs(b.top)>u-16)html+="<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(u-Math.floor(16/3))+"px'>+</div>";else{south_padding=K.pol===1?42:0;html+="<div class='timeglider-timeline-event "+b.css_class+" "+T+"' id='"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+(b.top+south_padding)+"px;font-size:"+b.fontsize+"px;'>"+D+k+J+"<div class='timeglider-event-title' style='top:"+
title_adj+"px'>"+b.title+"</div></div>"}}}}return{html:html,highest:highest}};var W=function(){K.tree=[];for(var R=0;R<300;R++)K.tree[R]=[]},A=function(R,u){var T=u.importance,J=R.importance;return T<J?-1:T>J?1:0},S=function(R,u){var T=false,J=K.tree,k=J[u],D=u+1,H=false,L=2;if(k!=undefined){for(L=0;L<k.length;L++){a:{T=k[L];if(!(R.left>T.right||R.right<T.left))if(R.left>=T.left&&R.left<=T.right||R.right>=T.left&&R.right<=T.right||R.right>=T.right&&R.left<=T.left||R.right<=T.right&&R.left>=T.left)if(R.bottom<=
T.bottom&&R.bottom>=T.top||R.top<=T.bottom&&R.top>=T.top||R.top==T.bottom&&R.top==T.top){T=true;break a}T=false}if(T==true){if(K.pol===-1){R.top-=U;R.bottom-=U}else{R.top+=U;R.bottom+=U}S(R,D);H=true;break}}if(H==false){if(K.pol===-1)R.top-=R.fontsize;else R.top+=R.fontsize;k.push(R);L=Math.ceil(R.height/U);for(k=1;k<=L;k++)J[u+k].push(R)}}}}})(timeglider);(function(l){var U=l.TG_Date,K=jQuery,C=U.units,W;l.TG_EventCollection=Backbone.Collection.extend({eventHash:{},setTimelineHash:function(A,S){this.eventHash[A]=S},getTimelineHash:function(A){return this.eventHash[A]},model:l.TG_Event});l.TG_Event=Backbone.Model.extend({urlRoot:"/event",defaults:{title:"Untitled"},initialize:function(A){if(A.image){if(typeof A.image=="string")A.image={id:A.id,src:A.image,display_class:A.image_class||"above",width:0,height:0};else{A.image.display_class=A.display_class||
"above";A.image.width=0;A.image.height=0}this.getEventImageSize(A.image)}else A.image="";A.titleWidth=l.getStringWidth(A.title);this.set(A)},validate:function(){},getEventImageSize:function(A){function S(T,J){return function(){return J.apply(T,arguments)}}var R=this,u=new Image;u.src=A.src;u.onerror=S(u,function(){});u.onload=S(u,function(){R.get("image").height=this.height;R.get("image").width=this.width})}});l.TG_TimelineCollection=Backbone.Collection.extend({model:l.TG_Timeline});l.TG_Timeline=
Backbone.Model.extend({urlRoot:"/timeline",defaults:{initial_zoom:25,focus_date:"today",timezone:"00:00",title:"Untitled",events:[],legend:[]},_chewTimeline:function(A){W=A.mediator;A.timeline_id=A.id;var S={all:[],da:[],mo:[],ye:[],de:[],ce:[],thou:[],tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]};A.spans=[];A.hasImagesAbove=false;A.startSeconds=[];A.endSeconds=[];A.focusDateObj=new U(A.focus_date);A.size_importance=A.size_importance=="false"?false:true;A.timeOffset=U.getTimeOffset(A.timezone||
"00:00");if(!A.color)A.color="#333333";if(A.events.length>0){for(var R,u,T,J,k=A.events.length,D=0;D<k;D++){u=A.events[D];if(u.id)T=u.id;else u.id=T="anon"+this.anonEventId++;if(u.map)if(W.main_map){if(timeglider.mapping.ready)u.map.marker_instance=timeglider.mapping.addAddMarkerToMap(u,W.main_map)}else l.googleMapsLoad();R=u.date_display||u.date_limit||"da";u.date_display=R.toLowerCase().substr(0,2);if(A.timeOffset.seconds){u.startdate=U.tzOffsetStr(u.startdate,A.timeOffset.string);if(u.enddate)u.enddate=
U.tzOffsetStr(u.enddate,A.timeOffset.string)}u.startdateObj=new U(u.startdate,u.date_display);if(u.enddate&&u.enddate!==u.startdate){u.enddateObj=new U(u.enddate,u.date_display);u.span=true;A.spans["s_"+u.id]={id:u.id,start:u.startdateObj.sec,end:u.enddateObj.sec}}else{u.enddateObj=u.startdateObj;u.span=false}A.startSeconds.push(u.startdateObj.sec);A.endSeconds.push(u.enddateObj.sec);u.cache={span:u.span,startdateObj:_.clone(u.startdateObj),enddateObj:_.clone(u.enddateObj)};if(u.image_class=="above")A.hasImagesAbove=
true;u.icon=!u.icon||u.icon==="none"?"":u.icon;S.all.push(T);for(var H=C.length,L=0;L<H;L++){R=C[L];J=U.getTimeUnitSerial(u.startdateObj,R);if(S[R][J]!==undefined)S[R][J].push(T);else S[R][J]=[T]}if(W.eventCollection.get(T))W.eventCollection.get(T).get("timelines").push(A.timeline_id);else{u.timelines=[A.timeline_id];u=new l.TG_Event(u);W.eventCollection.add(u)}}k=K.merge(A.startSeconds,A.endSeconds);k=_.sortBy(k,function(o){return parseInt(o)});A.bounds={first:_.first(k),last:_.last(k)};A.has_events=
true}else A.has_events=false;A.hasLegend=A.legend.length>0?true:false;A.display="expanded";W.eventCollection.setTimelineHash(A.timeline_id,S);delete A.events;return A},initialize:function(A){this.set(this._chewTimeline(A));this.bind("change",function(){})}})})(timeglider);(function(l){var U=l.TG_Date,K="",C="",W={},A=0,S=0,R=0,u=jQuery,T={},J="",k,D,H,L=u.support.touch?"touchstart":"click";l.TG_PlayerView=function(o,v){var E=this;C=v;W=C.options;K="#"+o._id;J=o._id;this._views={PLACE:K,CONTAINER:K+" .timeglider-container",DATE:K+" .timeglider-date-display",TIMELINE_MENU:K+" .timeglider-timeline-menu",TIMELINE_MENU_UL:K+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:K+" .timeglider-list-bt",SLIDER_CONTAINER:K+" .timeglider-slider-container",SLIDER:K+" .timeglider-slider",
ZOOM_DISPLAY:K+" .timeglider-zoomlevel-display",TRUCK:K+" .timeglider-truck",CENTERLINE:K+" .timeglider-centerline",TICKS:K+" .timeglider-ticks",HANDLE:K+" .timeglider-handle",FOOTER:K+" .timeglider-footer",FILTER_BT:K+" .timeglider-filter-bt",FILTER_BOX:K+" .timeglider-filter-box",SETTINGS_BT:K+" .timeglider-settings-bt"};k=this._views.CONTAINER;D=this._views.TICKS;H=this._views.DATE;this.initTimelineVOffset=100;this.tick_height=34;this.imageLaneHeight=60;this._templates={};this._templates={test:"testola",
event_modal_small:"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><div class='dateline'>{{html dateline}}</div><h4 id='title'>${title}</h4><p>{{html image}}{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>",event_modal_full:u.template(null,"<div class='tg-modal full_modal' id='ev_${id}_modal'><div class='full_modal_scrim'></div><div class='full_modal_panel'><div class='close-button full_modal_close'>x</div><div class='dateline'>{{html dateline}}</div><table><tr><td><h4>${title}</h4><div class='description'><p>{{html description}}</p></div></td><td><div>{{html image}}</div><div id='insert'></div></td></tr></table><div class='footer'><ul>{{html links}}</ul></div></div>"),
filter_modal:u.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:u.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),settings_modal:u.template(null,"<div class='timeglider-menu-modal timeglider-settings-modal'><div class='close-button'></div><h3>settings</h3><div class='timeglider-menu-modal-content'><div class='timeglider-settings-timezone'></div></div><div class='timeglider-menu-modal-point-right'></div>"),
legend_modal:u.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-display-none'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};this.timelineModal=l.TG_TimelineView.extend({tagName:"div",model:l.TG_Timeline,className:"tg-modal timeglider-timeline-modal ui-widget-content",events:{"click .close-button-remove":"remove"},
template:"<div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p>",initialize:function(){this.model.bind("change",this.render,this)},render:function(){u(this.el).html(u.tmpl(this.template,this.model.attributes)).attr("id",this.model.get("id")+"_timelineModal");return this},remove:function(){u(this.el).fadeOut()}});u(k).delegate(".tg-timeline-envelope .timeline-info","click",function(){var g=u(this).data("timeline_id");E.openTimelineModal(g)}).delegate(".tg-timeline-envelope .expand-collapse",
"click",function(){var g=u(this).data("timeline_id");E.expandCollapseTimeline(g)}).delegate(".tg-timeline-envelope .tg-timeline-legend-bt","click",function(){var g=u(this).data("timeline_id");E.legendModal(g)}).delegate(".close-button-remove","click",function(){var g=u(this).parent().attr("id");u("#"+g).remove()}).delegate(".full_modal_scrim, .full_modal_close","click",function(){u(".full_modal").remove()}).delegate(".timeglider-more-plus","click",function(){C.zoom(-1)}).delegate(".timeglider-legend-close",
"click",function(){var g=u(k+" .timeglider-legend");g.fadeOut(300,function(){g.remove()})}).delegate(".timeglider-legend-all","click",function(){u(k+" .timeglider-legend li").each(function(){u(this).removeClass("tg-legend-icon-selected")});C.setFilters({origin:"legend",icon:"all"})}).css("height",u(K).height());this.basicFontSize=W.basic_fontsize;W.show_footer==false&&u(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=
this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1E3;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();this.setPanButton(u(".timeglider-pan-right"),-30);this.setPanButton(u(".timeglider-pan-left"),30);u(this._views.TRUCK).bind("dblclick",function(g){C.registerUIEvent({name:"dblclick",event:g,dimensions:E.dimensions})}).bind("mousewheel",function(g,h){var y=Math.ceil(-1*h*3),p=C.getZoomLevel();C.setZoomLevel(p+y);return false});u(D).draggable({axis:"x",
start:function(){},drag:function(){S=Math.floor(u(this).position().left);C.setTicksOffset(S);A=S-R;debug.trace("::>>"+A,"note");R=S},stop:function(){debug.trace("::||"+A,"note");E.resetTicksHandle();E.registerDragging()}}).delegate(k+" .timeglider-timeline-event",L,function(){var g=u(this).attr("id"),h=C.eventCollection.get(g).attributes;debug.log("event id on touchstart/click:"+g);if(timeglider.mode!="authoring")if(h.click_callback){g=h.click_callback.split(".");var y=g.length;if(y==1)window[g[0]](h);
else if(y==2)window[g[0]][g[1]](h);else if(y==3)window[g[0]][g[1]][g[2]](h)}else E.eventModal(g)}).delegate(".timeglider-timeline-event","mouseover",function(){var g=C.eventCollection.get(u(this).attr("id")).attributes;E.eventHover(u(this),g)}).delegate(".timeglider-timeline-event","mouseout",function(){var g=C.eventCollection.get(u(this).attr("id")).attributes;E.eventUnHover(u(this),g)}).delegate(".timeglider-event-collapsed","hover",function(){var g=C.eventCollection.get(u(this).attr("id")).attributes.title;
debug.trace("collapsed, title:"+g,"note")});E.setCenterline();u.subscribe("mediator.ticksOffsetChange",function(){E.tickHangies();E.registerDragging();E.registerTitles()});u.subscribe("mediator.focusToEvent",function(){});u.subscribe("mediator.zoomLevelChange",function(){E.tickNum=0;E.leftside=0;var g=C.getZoomLevel();u(E._views.SLIDER).slider("value",E.invSliderVal(g));E.displayZoomLevel(g);E.castTicks("zoomLevelChange")});u.subscribe("viewer.rendered",function(){});u.subscribe("mediator.ticksReadySignal",
function(){C.ticksReady===true&&E.freshTimelines()});u.subscribe("mediator.refreshSignal",function(){E.tickNum=0;E.leftside=0;E.castTicks("refreshSignal")});u.subscribe("mediator.ticksArrayChange",function(){});u.subscribe("mediator.focusDateChange",function(){this.displayFocusDate()});u.subscribe("mediator.timelineDataLoaded",function(){u(".timeglider-loading").fadeOut(500);E.buildSettingsMenu();E.buildTimelineMenu()});u.subscribe("mediator.activeTimelinesChange",function(){u(E._views.TIMELINE_MENU_UL+
" li").each(function(){var g=u(this).data("timeline_id");u.inArray(g,C.activeTimelines)!=-1?u(this).addClass("activeTimeline"):u(this).removeClass("activeTimeline")})});u.subscribe("mediator.filterChange",function(){});if(u.support.touch){u("#"+J).addTouch();var P=document.getElementById(J);P.addEventListener("gesturestart",function(g){g.preventDefault();u("#output").append("<br>gesture zoom:"+C.getZoomLevel())},false);P.addEventListener("gestureend",function(g){g.preventDefault();u("#output").append("<br>gesture end:"+
C.getZoomLevel())},false);P.addEventListener("gesturechange",function(g){g.preventDefault();g.preventDefault();if(C.gesturing===false){C.gesturing=true;C.gestureStartZoom=C.getZoomLevel()}C.setZoomLevel(Math.ceil(C.gestureStartZoom/g.scale))},false)}};l.TG_PlayerView.prototype={resize:function(){var o=u(K).height();u(k).height(o);this.dimensions=this.getWidgetDimensions();this.setCenterline();C.refresh()},getWidgetDimensions:function(){var o=u(k),v=o.width(),E=Math.floor(v/2)+1,P=o.height(),g=Math.floor(P/
2),h=this.tick_height,y=o.position().left;o=o.offset();var p=W.show_footer==true?u(this._views.FOOTER).height():0;return{container:{width:v,height:P,centerx:E,centery:g,left:y,offset:o},tick:{top:P-p-h},footer:{height:p}}},scaleToImportance:function(o,v){return o/v},displayZoomLevel:function(){var o=C.getZoomLevel();o>0&&W.display_zoom_level==true&&u(this._views.ZOOM_DISPLAY).text(o)},displayFocusDate:function(){var o=C.getFocusDate();u(H).text(o.format("d MMM yyyy",false))},setPanButton:function(o,
v){var E=this;u(o).live("mousedown",function(){E.intervalMachine("pan",{type:"set",fn:E.pan,args:[v],intvl:33})}).live("mouseup",function(){E.intervalMachine("pan",{type:"clear",fn:E.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){E.intervalMachine("pan",{type:"clear",fn:E.pan,callback:"resetTicksHandle"})})},intervalMachine:function(o,v){var E=this;if(v.type==="clear"){clearInterval(T[o]);if(v.callback)E[v.callback]()}else T[o]=setInterval(function(){v.fn.apply(E,v.args)},v.intvl)},
invSliderVal:function(o){return Math.abs(o-101)},pan:function(o){o=o||20;$t=u(D);newPos=$t.position().left+o;$t.css({left:newPos});C.setTicksOffset(newPos)},registerTitles:function(){var o,v,E,P,g,h,y,p,m,x=u(k).offset().left;u(".timeglider-event-spanning").each(function(){o=u(this).offset().left-x;v=u(this).outerWidth();h=u(".timeglider-event-title",this);E=h.outerWidth()+5;P=h.siblings(".timeglider-event-spanner").outerWidth();P>E&&o<0&&Math.abs(o)<v-E&&h.css({marginLeft:-1*o+5})});u.browser.msie&&
parseInt(u.browser.version);u(".tg-timeline-envelope").each(function(){y=u(this);p=y.offset().left-x;$tb=y.find(".titleBar");g=$tb.data("lef");m=-1*(g+p);$ti=$tb.find(".timeline-title");m>0&&m<$tb.width()-$ti.width()&&$ti.css({marginLeft:m+5})})},registerDragging:function(){var o=C.startSec,v=u(D).position().left,E=C.getZoomInfo().spp;o=new U(o-v*E);C.setFocusDate(o);this.displayFocusDate()},setupFilter:function(){var o=this;$filter=u.tmpl(o._templates.filter_modal,{}).appendTo(o._views.CONTAINER);
$filter.css("z-index",o.ztop++).position({my:"right bottom",at:"right top",of:u(o._views.FILTER_BT),offset:"-8, -12"}).hide();u(k).delegate(".timeglider-filter-box .close-button","click",function(){$filter.fadeOut()});u(o._views.FILTER_BT).bind("click",function(){$filter.fadeIn();u(this);var v=o._views.FILTER_BOX;if(o.filterBoxActivated==false){o.filterBoxActivated=true;var E=u(v+" .timeglider-filter-apply"),P=u(".timeglider-filter-box .close-button"),g=u(v+" .timeglider-filter-clear"),h="",y="";
E.bind("click",function(){h=u(v+" .timeglider-filter-include").val();y=u(v+" .timeglider-filter-exclude").val();C.setFilters({origin:"clude",include:h,exclude:y});u(v).toggleClass("timeglider-display-block")});P.bind("click",function(){u(v).toggleClass("timeglider-display-none")});g.bind("click",function(){C.setFilters({origin:"clude",include:"",exclude:""});u(v+" .timeglider-filter-include").val("");u(v+" .timeglider-filter-exclude").val("");u(v).toggleClass("timeglider-display-block")})}})},buildTimelineMenu:function(){var o=
this,v;u(o._views.TIMELINE_LIST_BT);u(o._views.TIMELINE_MENU)[0]&&u(o._views.TIMELINE_MENU).remove();v=u.tmpl(o._templates.timeline_list_modal,{}).appendTo(o._views.CONTAINER);var E=Backbone.View.extend({initialize:function(){this.model.bind("change",this.render,this)},tagName:"li",className:"timeglider-timeline-list-item",template:"${title}",events:{click:"toggleTimeline"},toggleTimeline:function(){C.toggleTimeline(this.model.get("id"))},render:function(){var P=this.model.get("id");u(this.el).html(u.tmpl(this.template,
this.model.attributes)).data("timeline_id",P);return this}});u(o._views.TIMELINE_MENU_UL).html("");_.each(C.timelineCollection.models,function(P){u(o._views.TIMELINE_MENU_UL).append((new E({model:P})).render().el)});v.position({my:"right bottom",at:"right top",of:u(o._views.TIMELINE_LIST_BT),offset:"-8, -12"}).hide();u(k).delegate(".timeglider-timeline-menu .close-button","click",function(){v.fadeOut()}).delegate(this._views.TIMELINE_LIST_BT,"click",function(){v.fadeIn()})},getTimezonePulldown:function(o,
v){var E="<select name='timezone' id='"+o+"'>",P=false,g="selected";u.map(U.timezones,function(h){if(v==h.offset&&P==false){g="selected";P=true}else g="";E+="<option value='"+h.offset+"' "+g+">"+h.name+"</option>"});E+="</select>";return E},buildSettingsMenu:function(){var o=u.tmpl(this._templates.settings_modal,{}).appendTo(this._views.CONTAINER),v=this.getTimezonePulldown("timeglider-settings-timezone",C.timeOffset.string);o.find(".timeglider-settings-timezone").append('<p>Make changes below, then click on "save". More settings options to come!</p>').append('<span class="settings-label">timezone:</span> '+
v).append("<p style='clear:both'>&nbsp;</p><div class='btn success' id='timeglider-settings-save'>save</div>");o.position({my:"right bottom",at:"right top",of:u(this._views.SETTINGS_BT),offset:"-8, -12"}).hide();u(k).delegate(".timeglider-settings-modal .close-button","click",function(){o.fadeOut()}).delegate(this._views.SETTINGS_BT,"click",function(){o.fadeIn()}).delegate("#timeglider-settings-save","click",function(){var E=u(k+" #timeglider-settings-timezone").val();C.setTimeoffset(E)})},buildSlider:function(){var o=
C.getZoomLevel();if(W.min_zoom==W.max_zoom)u(this._views.SLIDER_CONTAINER).css("display","none");else{W.display_zoom_level==true&&u("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var v=this;o=v.invSliderVal(o);var E=C.max_zoom,P=C.min_zoom;u(this._views.SLIDER).css("height",(1+E-P)*3).slider({steps:100,handle:u(".knob"),animate:300,orientation:"vertical",min:v.invSliderVal(E),max:v.invSliderVal(P),value:o,start:function(){v.sliderActive=true},
stop:function(){v.sliderActive=false},change:function(){},slide:function(g,h){C.setZoomLevel(v.invSliderVal(h.value))}})}},getEventDateLine:function(o){var v="<span class='timeglider-dateline-startdate'>"+o.startdateObj.format("",true,C.timeOffset)+"</span>";endDateF="";if(o.span==true)endDateF=" &ndash; <span class='timeglider-dateline-enddate'>"+o.enddateObj.format("",true,C.timeOffset)+"</span>";return v+endDateF},eventHover:function(o,v){var E=u(".timeglider-event-hover-info");v.date_display!=
"no"&&E.position({my:"left bottom",at:"left top",of:o,offset:"1, -10",collision:"flip flip"}).html(this.getEventDateLine(v));o.addClass("tg-event-hovered")},eventUnHover:function(o){u(".timeglider-event-hover-info").css("left","-1000px");o.removeClass("tg-event-hovered")},clearTicks:function(){this.tickNum=this.leftside=0;u(D).css("left",0);u(k+" .tg-timeline-envelope").remove();u(k+" .timeglider-tick").remove()},castTicks:function(){this.clearTicks();C.getZoomLevel();var o=C.getFocusDate(),v=C.getZoomInfo().width;
v=Math.ceil(this.dimensions.container.width/v)+4;var E="l";C.setTicksReady(false);this.addTick({type:"init",focus_date:o});for(o=1;o<=v;o+=1){this.addTick({type:E});E=E=="l"?"r":"l"}C.setTicksReady(true);this.displayFocusDate()},addTick:function(o){var v=0,E=0,P=E=0,g=0,h=0,y="";g={};h={};P={};var p={};h={};p="";var m=0,x=1;y="";tickUnit=C.getZoomInfo().unit;tickWidth=C.getZoomInfo().width;focusDate=C.getFocusDate();tick_top=parseInt(this.dimensions.tick.top);g=C.addToTicksArray({type:o.type,unit:tickUnit},
focusDate);if(tickUnit=="mo"){h=U.getMonthAdj(g,tickWidth);tickWidth=h.width;v=h.days}this.tickNum++;if(o.type=="init"){h=this.tickOffsetFromDate(C.getZoomInfo(),C.getFocusDate(),tickWidth);this.leftside=E=Math.ceil(this.dimensions.container.centerx+h);this.rightside=E+tickWidth}else if(o.type=="l")this.leftside=E=Math.floor(this.leftside-tickWidth);else if(o.type=="r"){E=Math.floor(this.rightside);this.rightside+=tickWidth}C.getTickBySerial(g).width=tickWidth;C.getTickBySerial(g).left=E;y=this._views.PLACE+
"_"+tickUnit+"_"+g+"-"+this.tickNum;h=u("<div class='timeglider-tick' id='"+y+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(D);h.css({width:tickWidth,left:E,top:tick_top});P=this.getTickMarksInfo({unit:tickUnit,width:tickWidth});P=v||P.tperu;E=tickWidth/P;if(E>5){o=Raphael(y,tickWidth,30);var B="";for(v=0;v<P;v++){y=v*E;B+="M"+y+" 20 L"+y+" 30";if(tickUnit=="da"&&E>16){y=this.getHourLabelFromHour(m,E);p+="<div class='timeglider-tick-sub-label' style='width:"+(E-4)+"px'>"+
y+"</div>";m++}if(tickUnit=="mo"&&E>16){p+="<div class='timeglider-tick-sub-label' style='width:"+(E-4)+"px'>"+x+"</div>";x++}}o.path(B).attr({stroke:"#333","stroke-width":1})}p&&h.append("<div style='width:"+(tickWidth+10)+"px;position:absolute;top:17px;left:0;overflow:hidden'>"+p+"</div>");p={unit:tickUnit,width:tickWidth,serial:g};g=this.getDateLabelForTick(p);h.children("#label").text(g);return p},setCenterline:function(){C.options.show_centerline===true?u(this._views.CENTERLINE).css({height:this.dimensions.container.height,
left:this.dimensions.container.centerx}):u(this._views.CENTERLINE).css({display:"none"})},getHourLabelFromHour:function(o,v){var E="";E=E="";E=o>12?o-12:o;if(E==0)E=12;return E+(v>60?":00":"")+(o>11?" pm":" am")},getTickMarksInfo:function(o){switch(o.unit){case "da":o=24;break;case "mo":o=30;break;case "ye":o=12;break;default:o=10}return{tperu:o}},getDateLabelForTick:function(o){var v=o.serial,E=o.width;switch(o.unit){case "bill":return v==0?"1":v>0?v+" billion":v+" b.y. bce";case "hundredmill":return v==
0?"1":v>0?v+"00 million":v+"00 m.y. bce";case "tenmill":return v==0?"1":v>0?v+"0 million":v+"0 m.y. bce";case "mill":return v==0?"1":v>0?v+" million":v+" m.y. bce";case "hundredthou":return v==0?"1":v>0?v+"00,000":v+"00,000 bce";case "tenthou":return v==0?"1":v>0?v+"0,000":v+"0,000 bce";case "thou":return v==0?"1("+v+")":v>0?v+"000":v+"000 bce";case "ce":return v==0?"1("+v+")":v>0?v+"00":v+"00 bce";case "de":return v>120?v*10+"s":v*10;case "ye":return v;case "mo":o=U.getDateFromMonthNum(v);return E<
120?U.monthNamesAbbr[o.mo]+" "+o.ye:U.monthNames[o.mo]+", "+o.ye;case "da":o=new U(U.getDateFromRD(v));return E<120?U.monthNamesAbbr[o.mo]+" "+o.da+", "+o.ye:U.monthNames[o.mo]+" "+o.da+", "+o.ye;default:return o.unit+":"+v+":"+E}},tickHangies:function(){var o=u(D).position().left,v=this.rightside+o-this.dimensions.container.width;if(this.leftside+o>-100){o=this.addTick({type:"l"});this.appendTimelines(o)}else if(v<100){o=this.addTick({type:"r"});this.appendTimelines(o)}},tickOffsetFromDate:function(o,
v,E){switch(o.unit){case "da":v=v.ho/24+v.mi/1440;E*=v;break;case "mo":o=U.getMonthDays(v.mo,v.ye);v=(v.da-1)/o+v.ho/(24*o)+v.mi/(1440*o);E*=v;break;case "ye":v=((v.mo-1)*30+v.da)/365;E*=v;break;case "de":v=v.ye%10/10+v.mo/120;E*=v;break;case "ce":v=v.ye%100/100+v.mo/1200;E*=v;break;case "thou":v=v.ye%1E3/1E3;E*=v;break;case "tenthou":v=v.ye%1E4/1E4;E*=v;break;case "hundredthou":v=v.ye%1E5/1E5;E*=v;break;default:E=0}return-1*E},resetTicksHandle:function(){u(this._views.HANDLE).offset({left:u(k).offset().left})},
easeOutTicks:function(){Math.abs(A)>5&&u(D).animate({left:"+="+3*A},1E3,"easeOutQuad",function(){debug.trace("stopping easing","note")})},getTimelineEventsByTick:function(o){var v=o.tick.unit,E=o.tick.serial;o=C.eventCollection.getTimelineHash(o.timeline.timeline_id);return o[v][E]&&o[v][E].length>0?o[v][E]:0},passesFilters:function(o,v){var E=true,P="",g=[],h;P="";g=[];if(v<o.low_threshold||v>o.high_threshold)return false;if(P=C.filters.include){g=P.split(",");E=false;for(h=0;h<g.length;h++){P=RegExp(u.trim(g[h]),
"i");if(o.title.match(P))E=true}}if(P=C.filters.exclude){g=P.split(",");for(h=0;h<g.length;h++){P=RegExp(u.trim(g[h]),"i");if(o.title.match(P))E=false}}P=o.icon;if(C.filters.legend.length>0)if(u.inArray(P,C.filters.legend)==-1)E=false;return E},freshTimelines:function(){var o,v,E,P=C.activeTimelines,g=C.ticksArray,h="",y;v="";var p=this.dimensions.container.centerx;o=this.dimensions.container.width;var m=C.getFocusDate().sec,x=C.getZoomInfo().spp;C.getZoomInfo();v=[];var B=[],F=m-Math.floor(x*(o/
2));E=y=0;for(var Q,i=0,q=this.dimensions.container.height,z=i=0;z<P.length;z++){B=[];v=C.timelineCollection.get(P[z]);o=v.attributes;Q=o.display;i=o.top?parseInt(o.top.replace("px","")):q-this.initTimelineVOffset;v=new l.TG_TimelineView({model:v});y=C.timeOffset.seconds/x;$tl=u(v.render().el).appendTo(D);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){var G=u(this).css("top"),O=u(this).attr("id");C.timelineCollection.get(O).set({top:G});C.refresh()}}).css({top:i,left:y});y=$tl.find(".titleBar");
if(typeof o.bounds!="undefined"){v=p+(o.bounds.first-m)/x;E=p+(o.bounds.last-m)/x}else{v=p;E=p+300}E-=v;y.css({top:void 0,left:v,width:E}).data({lef:v,wid:E});if(Q=="expanded")o.borg=h=new timeglider.TG_Org;for(y=0;y<g.length;y++){v=this.getTimelineEventsByTick({tick:g[y],timeline:o});u.merge(B,v)}_.each(o.spans,function(G){G.start<F&&G.end>F&&u.inArray(G.id,B)==-1&&B.unshift(G.id)});v=this.compileTickEventsAsHtml(o,B,0,"sweep");i=W.event_overflow=="scroll"?0:o.hasImagesAbove?i-this.imageLaneHeight:
i;if(Q=="expanded"){v=h.getHTML("sweep",i);o.borg=h.getBorg()}v!="undefined"&&$tl.append(v.html);this.registerEventImages($tl)}this.registerTitles();u.publish("viewer.rendered")},appendTimelines:function(o){for(var v=C.activeTimelines,E,P="",g=0;g<v.length;g++){E=C.timelineCollection.get(v[g]).attributes;idArr=this.getTimelineEventsByTick({tick:o,timeline:E});P=this.compileTickEventsAsHtml(E,idArr,o.serial,"append");if(E.display=="expanded")P=E.borg.getHTML(o.serial,E.top);E=u(k+" .tg-timeline-envelope#"+
E.id).append(P.html);debug.log("append, stuff.highest:",P.highest);this.registerEventImages(E)}u.publish("viewer.rendered")},compileTickEventsAsHtml:function(o,v,E,P){var g;g=0;var h=this.dimensions.container.centerx,y=o.display,p=$tl.height();stuff="";foSec=C.startSec;spp=C.getZoomInfo().spp;zl=C.getZoomInfo().level;buffer=20;borg=o.borg;block_arg="sweep";if(P=="append")block_arg=E;for(E=0;E<v.length;E++){ev=C.eventCollection.get(v[E]).attributes;if(this.passesFilters(ev,zl)===true){g=h+(ev.startdateObj.sec-
foSec)/spp;if(y=="expanded"){impq=o.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;ev.fontsize=this.basicFontSize*impq;ev.left=g;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width)ev.width=ev.spanwidth}g=0;if(ev.image&&ev.image.display_class==="layout"){g=ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+g;ev.top=p-ev.height;
borg.addBlock(ev,block_arg)}else if(y=="collapsed")stuff+="<div id='"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(p-2)+"px;left:"+g+"px'></div>"}}return y=="collapsed"?stuff:""},registerEventImages:function(o){u(k+" .timeglider-event-image-bar").each(function(){u(this).position({my:"top",at:"bottom",of:o,offset:"0, 0"}).css("left",0)});u(k+" .timeglider-event-image-above").each(function(){u(this).position({my:"top",at:"top",of:u(k),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(o){o=
C.timelineCollection.get(o).attributes;o.display=o.display=="expanded"?"collapsed":"expanded";C.refresh()},openTimelineModal:function(o){o=new this.timelineModal({model:C.timelineCollection.get(o)});u(o.render().el).appendTo("body").position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).css("z-index",this.ztop++).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(o){if(!o)return"";var v="",E=0,P="",g="";if(typeof o=="string")v="<li><a href='"+
o+"' target='_blank'>link</a></li>";else if(typeof o=="object")for(E=0;E<o.length;E++){P=o[E].url;g=o[E].label;v+="<li><a href='"+P+"' target='_blank'>"+g+"</a></li>"}return v},eventModal:function(o){u(k+" #"+o+"_modal").remove();var v=this,E=false,P=false,g="";g={};g=0;var h=W.event_modal.type;g=u("#"+o);var y=C.eventCollection.get(o).attributes,p=y.image&&y.image.src?"<img src='"+y.image.src+"'>":"",m=this.createEventLinksMenu(y.link);o={title:y.title,description:y.description,id:o,dateline:v.getEventDateLine(y),
links:m,image:p,video:y.video};if(y.video){o.video=y.video;h="full";P=true}else if(y.map)if(y.map.latlong){E=true;h="full"}switch(h){case "full":o=u.tmpl(v._templates.event_modal_full,o);o.appendTo(k).css({"z-index":v.ztop++}).position({my:"left top",at:"left top",of:k,offset:"0, 0",collision:"none none"});if(E==true){o.find("#insert").append("<div id='map_modal_map'></div>");g=y.map.zoom||12;llarr=String(y.map.latlong).split(",");map_ll=new google.maps.LatLng(parseFloat(llarr[0]),parseFloat(llarr[1]));
g={zoom:g,center:map_ll,mapTypeId:google.maps.MapTypeId.ROADMAP};g=new google.maps.Map(u("#map_modal_map")[0],g);if(y.map.markers)for(E=0;E<y.map.markers.length;E++){P=y.map.markers[E];new google.maps.MarkerImage(P.image,new google.maps.Size(24,32),new google.maps.Point(0,0),new google.maps.Point(0,32));o=P.latlong.split(",");o=new google.maps.LatLng(o[0],o[1]);P=new google.maps.Marker({position:o,map:g,icon:P.icon,title:P.title,zIndex:P.zIndex})}}else P==true&&o.find("#insert").append("<iframe width='100%' height='300' src='"+
y.video+"'></iframe></div>");y=v.dimensions.container.height;E=v.dimensions.container.width;P=u(k+" .full_modal_panel");o=P.width();g=P.height();P.css({top:(y-g)/2+"px",left:(E-o)/2+"px"});break;case "video":o=u.tmpl(v._templates.event_modal_video,o);o.appendTo(D).css("z-index",v.ztop++).position({my:"right center",at:"left center",of:g,offset:"-12, -1",collision:"flip fit"}).hover(function(){u(this).css("z-index",v.ztop++)});break;default:o=u.tmpl(v._templates.event_modal_small,o);o.appendTo(D).css("z-index",
v.ztop++).position({my:"center top",at:"center top",of:k,offset:"0, 100",collision:"fit fit"}).draggable().hover(function(){u(this).css("z-index",v.ztop++)})}},legendModal:function(o){var v=C.timelineCollection.get(o).attributes.legend,E=0,P="",g="",h="";E="";for(E=0;E<v.length;E++){P=W.icon_folder+v[E].icon;g=v[E].title;h+="<li><img class='legend-icon' src='"+P+"'><span class='legend-info'>"+g+"</span></li>"}o={id:o,legend_list:h};u(k+" .timeglider-legend").remove();u.tmpl(this._templates.legend_modal,
o).appendTo(k).css("z-index",this.ztop++).toggleClass("timeglider-display-none").position({my:"left top",at:"left top",of:k,offset:"16, -4",collision:"none none"});E=timeglider.mode==="authoring"?k+" .legend-info":k+" .legend-info, "+k+" .legend-icon";u(E).bind("mouseup",function(){var y=u(this).next(".timeglider-legend");debug.log("legend_item...:",y);y=y.children("img").attr("src");debug.log("legend icon...:",y);u(this).parent().toggleClass("tg-legend-icon-selected");C.setFilters({origin:"legend",
icon:y})})},parseHTMLTable:function(o){var v={},E=+new Date,P=[];u("#"+o).find("tr").each(function(g){var h=u(this).children(),y;if(g===0)P=h.map(function(){return u(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{y={};h.each(function(p){y[P[p]]=u(this).text()});v["prefix"+E++]=y}});return v}};l.TG_TimelineView=Backbone.View.extend({initialize:function(){var o=this;this.model.bind("change:title",function(){u(o.el).find(".timeline-title-span").text(o.model.get("title"))});this.model.bind("destroy",
this.remove,this)},tagName:"div",events:{"click .timeline-title-span":"titleClick"},className:"tg-timeline-envelope",getTemplate:function(){var o="<div class='titleBar'><div class='timeline-title'><span class='timeline-title-span'>${title}</span><div class='tg-timeline-env-buttons'>";if(this.model.get("description"))o+="<span class='timeline-info' data-timeline_id='${id}'>info</span>";if(this.model.get("hasLegend"))o+="<span class='tg-timeline-legend-bt' data-timeline_id='${id}'>legend</span>";o+=
"<span class='expand-collapse' data-timeline_id='${id}'>exp/col</span>";o+="</div></div></div>";return o},render:function(){this.model.get("id");this.model.get("title");var o=this.getTemplate();u(this.el).html(u.tmpl(o,this.model.attributes)).attr("id",this.model.get("id"));return this},setText:function(){},titleClick:function(){C.timelineTitleClick(this.model.get("id"))},remove:function(){u(this.el).remove()}});l.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,
level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",
width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},
{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,
label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",
width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},
{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},
{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",
width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},
{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",
width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,
label:"100 billion years"}];l.calculateSecPerPx=function(o){for(var v=1;v<o.length;v++){var E=o[v],P=0;switch(E.unit){case "da":P=86400;break;case "mo":P=2419200;break;case "ye":P=31536E3;break;case "de":P=31536E4;break;case "ce":P=31536E5;break;case "thou":P=31536E6;break;case "tenthou":P=31536E7;break;case "hundredthou":P=31536E8;break;case "mill":P=31536E9;break;case "tenmill":P=31536E10;break;case "hundredmill":P=31536E11;break;case "bill":P=31536E12}E.spp=P/parseInt(E.width)}}(l.zoomTree);l.getStringWidth=
function(o){if(o)return u("#timeglider-measure-span").html(o).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")};if(debug)debug.trace=function(o,v){u("#"+v).text(o)};l.googleMapsInit=function(){};l.googleMapsLoaded=false;l.googleMapsLoad=function(){if(l.googleMapsLoaded==false){var o=document.createElement("script");o.type="text/javascript";o.src="http://maps.googleapis.com/maps/api/js?sensor=false&callback=timeglider.googleMapsInit";document.body.appendChild(o);
l.googleMapsLoaded=true}}})(timeglider);(function(l){var U={},K=l.TG_Date,C={},W=jQuery;l.TG_Mediator=function(A){this.options=C=A;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=C.max_zoom;this.min_zoom=C.min_zoom;this.icon_folder=l.icon_folder=C.icon_folder||"js/timeglider/icons/";this.timeOffset=K.getTimeOffset(C.timezone);this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartScale=this.gestureStartZoom=
0;this.filters={include:"",exclude:"",legend:[]};this.timelineCollection=new l.TG_TimelineCollection;this.eventCollection=new l.TG_EventCollection;this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.initial_timeline_id=C.initial_timeline_id||"";this.focusedEvent=this.sole_timeline_id="";if(C.max_zoom===C.min_zoom)this.fixed_zoom=C.min_zoom;if(C.main_map){this.main_map=C.main_map;timeglider.mapping.setMap(this.main_map,this)}U=this};l.TG_Mediator.prototype={focusToEvent:function(A){this.focusedEvent=
A;this.setFocusDate(A.startdateObj);W.publish("mediator.focusToEvent")},gotoDateZoom:function(A,S){var R=false;this.setFocusDate(new K(A));if(S)R=this.setZoomLevel(S);if(!S||R==false)this.refresh()},zoom:function(A){this.setZoomLevel(this.getZoomLevel()+parseInt(A))},loadTimelineData:function(A){var S=this;if(A)if(typeof A==="object")S.parseData(A);else if(A.substr(0,1)=="#"){A=[S.getTableTimelineData(A)];S.parseData(A)}else W.getJSON(A,function(R){S.parseData(R)});else{this.timelineDataLoaded=true;
this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},mapMarkerClick:function(A){this.focusToEvent(A)},getTimelineCollection:function(){return this.timelineCollection},timelineTitleClick:function(A){W.publish("mediator.timelineTitleClick",{timeline_id:A})},getTableTimelineData:function(A){var S={},R=0,u=[],T,J,k="",D=W(A);S.id=A.substr(1);S.title=D.attr("title")||"untitled";S.description=D.attr("description")||"";S.focus_date=D.attr("focus_date")||K.getToday;S.initial_zoom=
D.attr("initial_zoom")||20;S.events=[];D.find("tr").each(function(H){var L=W(this).children(),o;if(H===0)u=L.map(function(){return W(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{o={};L.each(function(v){T=u[v];J=W(this).text();o[T]=J});k="ev_"+R++;o.id=k;S.events.push(o)}});D.css("display","none");return S},parseData:function(A){var S=0,R=A.length,u={};u={};for(var T=0;T<R;T++){u=A[T];u.mediator=this;u=(new l.TG_Timeline(u)).toJSON();if(u.id.length>0){S++;this.swallowTimeline(u)}}if(S===
0)alert("ERROR loading data: Check JSON with jsonLint");else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var A=this.timelineDataLoaded==true;if(this.imagesSized==this.imagesToSize&&A){this.setInitialTimelines();W.publish("mediator.timelineDataLoaded")}},swallowTimeline:function(A){this.sole_timeline_id=A.id;this.timelineCollection.add(A);W.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var A=this.initial_timeline_id||this.sole_timeline_id;if(timeglider.mode==
"authoring")this.setZoomLevel(40);else A?setTimeout(function(){U.toggleTimeline(A)},500):this.setZoomLevel(40)},refresh:function(){this.startSec=this._focusDate.sec;W.publish("mediator.refreshSignal")},setTicksReady:function(A){this.ticksReady=A;A===true&&W.publish("mediator.ticksReadySignal")},setTimeoffset:function(A){this.timeOffset=K.getTimeOffset(A);this.refresh()},getTimeoffset:function(){return this.timeOffset},setFocusDate:function(A){if(A!=this._focusDate)this._focusDate=A},getFocusDate:function(){return this._focusDate},
getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(A){if(A<=this.max_zoom&&A>=this.min_zoom){this.startSec=this._focusDate.sec;if(A!=this._zoomLevel){this._zoomLevel=A;this._zoomInfo=l.zoomTree[A];W.publish("mediator.zoomLevelChange");return true}else return false}else return false},getZoomInfo:function(){return this._zoomInfo},registerUIEvent:function(A){switch(A.name){case "dblclick":A=A.event.pageX-A.dimensions.container.offset.left-A.dimensions.container.width/2;var S=
this.getZoomInfo().spp,R=this.getFocusDate().sec;A=new K(Math.floor(R+A*S));W.publish("mediator.dblclick",{date:A})}},setFilters:function(A){switch(A.origin){case "clude":this.filters.include=A.include;this.filters.exclude=A.exclude;break;case "legend":var S=_.last(A.icon.split("/"));if(S=="all"){this.filters.legend=[];W.publish("mediator.legendAll")}else if(W.inArray(S,this.filters.legend)==-1){debug.log("icon to put in legend filter:",S);this.filters.legend.push(S)}else{A=[];A=W.grep(this.filters.legend,
function(R){return R!=S});this.filters.legend=A}}W.publish("mediator.filtersChange");this.refresh()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(A){this._ticksOffset=A;W.publish("mediator.ticksOffsetChange")},getTickBySerial:function(A){for(var S=this.ticksArray,R=S.length,u=0;u<R;u++){var T=S[u];if(T.serial==A)return T}return false},addToTicksArray:function(A,S){if(A.type=="init"){A.serial=K.getTimeUnitSerial(S,A.unit);this.ticksArray=[A]}else if(A.type=="l"){A.serial=
this.ticksArray[0].serial-1;this.ticksArray.unshift(A)}else{A.serial=this.ticksArray[this.ticksArray.length-1].serial+1;this.ticksArray.push(A)}W.publish("mediator.ticksArrayChange");return A.serial},toggleTimeline:function(A){var S=this.timelineCollection.get(A).attributes,R=W.inArray(A,this.activeTimelines);if(R==-1){this.activeTimelines.push(A);this.setFocusDate(new K(S.focus_date));this.setZoomLevel(S.initial_zoom)}else{this.activeTimelines.splice(R,1);this.refresh()}W.publish("mediator.activeTimelinesChange")},
reportImageSize:function(A){var S=U.eventCollection.get(A.id);if(S.has("image")){if(A.error){S.attributes.image={};debug.log("WHOOPS: MISSING IMAGE: "+A.src)}else{S.attributes.image.width=A.width;S.attributes.image.height=A.height}this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}}};l.getLowHigh=function(A){A=_.sortBy(A,function(S){return parseInt(S)});return{low:_.first(A),high:_.last(A)}};l.validateOptions=function(A){this.optionsMaster={initial_focus:{type:"date"},timezone:{type:"timezone"},
editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},
event_modal:{type:"object"},event_overflow:{type:"string"}};var S=this,R="";W.each(A,function(u,T){if(S.optionsMaster[u])switch(S.optionsMaster[u].type){case "string":if(typeof T!="string")R+=u+" needs to be a string.\n";if(S.optionsMaster[u].possible)if(W.inArray(T,S.optionsMaster[u].possible)==-1)R+=u+" must be: "+S.optionsMaster[u].possible.join(" or ");break;case "number":if(typeof T!="number")R+=T+" needs to be a number.\n";if(S.optionsMaster[u].min)if(T<S.optionsMaster[u].min)R+=u+" must be greater than or equal to "+
S.optionsMaster[u].min+"\n";if(S.optionsMaster[u].max)if(T>S.optionsMaster[u].max)R+=u+" must be less than or equal to "+S.optionsMaster[u].max+"\n";break;case "timezone":var J=/[+|-]?[0-9]+:[0-9]+/;if(W.inArray(T,["New York","Denver","Chicago","Los Angeles"])==-1&&T.match(J)==-1)R+="The timezone is not formatted properly";break;case "boolean":if(typeof T!="boolean")R+=T+" needs to be a number.\n"}});return R}})(timeglider);(function(l){var U,K,C=timeglider,W=timeglider.TG_Date;l.widget("timeglider.timeline",{options:{timezone:"00:00",initial_focus:C.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true,event_modal:{href:"",type:"default"},event_overflow:"plus"},_create:function(){this._id=l(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-date-display'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-filter-bt'></div><div class='timeglider-footer-button timeglider-settings-bt'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var A=timeglider.validateOptions(this.options);if(A==""){C.TG_Date.setCulture(this.options.culture);K=new C.TG_Mediator(this.options);U=new C.TG_PlayerView(this,K);K.setFocusDate(new W(this.options.initial_focus));K.loadTimelineData(this.options.data_source)}else alert("Rats. There's a problem with your widget settings:"+A)},goTo:function(A,S){K.gotoDateZoom(A,S)},resize:function(){U.resize()},getMediator:function(){return K},zoom:function(A){switch(A){case "in":A=-1;break;case "out":A=
1}if(A>99||A<-99)return false;K.zoom(A)},load:function(A){K.loadTimelineData(A)},panButton:function(A,S){var R=0;switch(S){case "left":R=30;break;case "right":R=-30;break;default:R=S}U.setPanButton(A,R)},destroy:function(){l.Widget.prototype.destroy.apply(this,arguments);l(this.element).html("")}})})(jQuery);
